@using Kaizen.Models.AdminModel
@using Kaizen.Models.NewKaizen;
@inject IHttpContextAccessor Accessor
@using Newtonsoft.Json;

@{
    var managerListJson = Accessor.HttpContext.Session.GetString("ManagerList");
    List<ManagerModel> managerList = new List<ManagerModel>();

    if (!string.IsNullOrEmpty(managerListJson))
    {
        managerList = JsonConvert.DeserializeObject<List<ManagerModel>>(managerListJson);
    }
}
@model NewKaizenModel;
@{
    Layout = "SidebarLayout";
}
<style>
    .approved {
        color: green;
    }

    .rejected {
        color: red;
    }

    .pending {
        color: orange; 
    }

    .btn-danger {
        color: #fff!important;
        background-color: #dc3545!important;
        border-color: #dc3545!important;
    }
    .btn-azure{
        color: #fff !important;
    }

    #approvers {
        display: none;
    }

    .input-width {
        width: 100%;
    }

    table {
        width: 100%;
        border-collapse: collapse;
    }

    th, td {
        
        border: 1px solid #ddd;
    }

    th {
        background-color: #f4f4f4;
    }

    .col-lg-4 {
        width: 25%;
    }

    .input-width {
        width: 100%;
    }

    .btn-success {
        pointer-events: none;
        cursor: not-allowed!important;
    }

    /* for only numbers */
    input[type="number"]::-webkit-outer-spin-button,
    input[type="number"]::-webkit-inner-spin-button {
        -webkit-appearance: none;
        margin: 0;
    }
    input[type="number"] {
        -moz-appearance: textfield;
    }

    .hidden123 {
        display: none; 
    }

    .show {
        display: block; /* or whatever style you use to show elements */
    }

    #uploaded_additional_image {
        display: flex;
        flex-wrap: wrap;
        gap: 20px;
    }
    #uploaded_additional_image .img-container 
    {
        display: inline-block;
        text-align: center;
        margin: 7px;
        box-sizing: border-box;
        background: #fff;
        border-radius: 7px;
        border: 1px dashed #797A89;
        transition: all .2s ease;
        width: 200px;
        position: relative;
    }

    #uploaded_additional_image .img-container img 
    {
        width: 100%;
        height: 118px;
        border-radius: 5px;
        user-select: none;
                
    }
    .delete-btn 
    {
        display: block;
        background-color: #f44336;
        color: white;
        border: none;
        cursor: pointer;
        box-sizing: border-box;
        transition: background-color .2s ease;
    }
    select {
        background-color: #f0f0f0;
        border: 1px solid #ccc;
        padding: 8px;
        width: 100%; 
    }

    .dropdown.bootstrap-select .form-control {
        background-color: #f0f0f0; 
        border: 1px solid #ccc;
    }

</style>
<link href="~/assets/css/custom/newkaizen.css" rel="stylesheet" />
<div class="content-body body mb-2" id="ReadOnly" >
    <div class="container-fluid">
        <!-- Page Title -->
        <div class="row page-titles mx-0 mt-2">
            <div class="col-sm-12 p-md-0">
                <div class="welcome-text">
                    <a id="backbtn" class="btn btn-warning float-right ml-1">Back</a>
                    <a id="printPDF" class="btn btn-azure float-right">Download PDF</a>
                    <div id="modalPlaceholder"></div>
                    <h4>Create Kaizen<button class="btn btn-azure float-right" style="margin-right:2px;" type="button" onclick="loadModalContent()">Sample Kaizen Form</button></h4>
                    <p class="responsemessage"></p>
                </div>
            </div>
        </div>
        <!-- END Page Title -->
        <!-- Accordion Section -->
        <div id="downloadDiv">
        <div class="accordion-bral">

            <!-- Accordion Item 1 -->

            <input class="ac-input" id="ac-1" name="accordion-1" type="checkbox" checked />

            <label class="ac-label" for="ac-1"> Create Kaizen Details <i></i></label>

            <div class="article ac-content">

                <div class="card-body">
                    @* <h3 class="card-title">Post My Idea</h3> *@
                    <hr><br>
                    <div class="basic-form">
                        <div class="col-lg-12">

                            <div class="row">
                                <!-- 1th box -->
                                <div class="col-lg-3">
                                    <div class="carddashed">

                                        <div class="card-body">

                                            <div class="right-box-padding">

                                                <div class="read-content">
                                                    <div class="row justify-content-center">

                                                        <div class="card-body text-center">

                                                            <img src="~/assets/img/tatalogo.png" class="kaizenlogo" alt="TEPL KAIZEN IDEA Logo">

                                                            <br><b>TEPL KAIZEN IDEA</b>

                                                        </div>

                                                    </div>
                                                </div>

                                            </div>

                                        </div>

                                    </div>

                                </div>
                                <!-- 2th box -->
                                <div class="col-lg-4">
                                    <div class="carddashed">
                                        <div class="card-body">

                                            <div class="right-box-padding">
                                                <div class="read-content">

                                                    <div class="card-body">

                                                        <div class="activity-group" id="checkboxform">
                                                            <label>ACTIVITY</label>
                                                            <label data-toggle="popover" data-trigger="hover" data-placement="top" data-html="true" data-content='<img src="/assets/img/tooltip-imgs/activity.png" height="40" />' title="ACTIVITY [Example]">
                                                                <input type="checkbox" class="hideradio" id="idMURA" value="MURA">MURA
                                                            </label>

                                                            <label data-toggle="popover" data-trigger="hover" data-placement="top" data-html="true" data-content='<img src="/assets/img/tooltip-imgs/activity.png" height="40" />' title="ACTIVITY [Example]">
                                                                <input type="checkbox" class="hideradio" id="idMURI" value="MURI"> MURI
                                                            </label>

                                                            <label data-toggle="popover" data-trigger="hover" data-placement="top" data-html="true" data-content='<img src="/assets/img/tooltip-imgs/activity.png" height="40"; />' title="ACTIVITY [Example]">
                                                                <input type="checkbox" class="hideradio" id="idMUDA" value="MUDA"> MUDA
                                                            </label>
                                                        </div>

                                                        <div class="form-group">
                                                            <textarea class="form-control mb10" name="activity_desc" id="activityDesc" value="@Model.ActivityDesc"></textarea>
                                                        </div>
                                                            <input type="text" id="bindtxtID" value="@Model.Id" hidden />
                                                        <div class="form-group" id="checkboxform1">
                                                            <!-- <label> -->
                                                            <label class="d-block">Benefit Area <span class="mandatory">*</span></label>

                                                            <label class="tab tabcheckbox" data-toggle="popover" data-trigger="hover" data-placement="top" data-html="true" data-content='<img src="/assets/img/tooltip-imgs/benifitarea.png" height="50" />' title="Benefit Area [Example]">
                                                                <input type="checkbox" value="P" id="iP" class="tab-input">
                                                                <div class="tab-box">P</div>
                                                            </label>

                                                            <label class="tab tabcheckbox" data-toggle="popover" data-trigger="hover" data-placement="top" data-html="true" data-content='<img src="/assets/img/tooltip-imgs/benifitarea.png" height="50" />' title="Benefit Area [Example]">
                                                                <input type="checkbox" value="Q" id="iQ"class="tab-input">
                                                                <div class="tab-box">Q</div>
                                                            </label>

                                                                <label class="tab tabcheckbox" data-toggle="popover" data-trigger="hover" data-placement="top" data-html="true" data-content='<img src="/assets/img/tooltip-imgs/benifitarea.png" height="50" />' title="Benefit Area [Example]">
                                                                    <input type="checkbox" value="C" id="iC" class="tab-input">
                                                                    <div class="tab-box">C</div>
                                                                </label>

                                                            <label class="tab tabcheckbox" data-toggle="popover" data-trigger="hover" data-placement="top" data-html="true" data-content='<img src="/assets/img/tooltip-imgs/benifitarea.png" height="50" />' title="Benefit Area [Example]">
                                                                <input type="checkbox" value="D" id="iD"class="tab-input">
                                                                <div class="tab-box">D</div>
                                                            </label>

                                                            <label class="tab tabcheckbox" data-toggle="popover" data-trigger="hover" data-placement="top" data-html="true" data-content='<img src="/assets/img/tooltip-imgs/benifitarea.png" height="50" />' title="Benefit Area [Example]">
                                                                <input type="checkbox" value="S" id="iS" class="tab-input">
                                                                <div class="tab-box">S</div>
                                                            </label>

                                                            <label class="tab tabcheckbox" data-toggle="popover" data-trigger="hover" data-placement="top" data-html="true" data-content='<img src="/assets/img/tooltip-imgs/benifitarea.png" height="50" />' title="Benefit Area [Example]">
                                                                <input type="checkbox" value="M" id="iM" class="tab-input">
                                                                <div class="tab-box">M</div>
                                                            </label>

                                                            <label class="tab tabcheckbox " data-toggle="popover" data-trigger="hover" data-placement="top" data-html="true" data-content='<img src="/assets/img/tooltip-imgs/benifitarea.png" height="50" />' title="Benefit Area [Example]">
                                                                <input type="checkbox" value="E" id="iE"class="tab-input">
                                                                <div class="tab-box">E</div>
                                                            </label>
                                                            <!-- </label> -->
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                        </div>
                                    </div>
                                </div>
                                <!-- end2nd -->
                                <!--3rd-->
                                <div class="col-lg-5">
                                    <div class="carddashed">
                                        <div class="card-body">

                                            <div class="right-box-padding">
                                                <div class="read-content">

                                                    <div class="card-body">

                                                        <div class="row">
                                                                <div class="col-sm-6" id="Srno">
                                                                <div class="form-group">
                                                                    <label>Sr.No<span class="mandatory">*</span></label>
                                                                        <input type="text" name="versionNo" id="versionNo" class="form-control mb10" value="01/ @Model.OriginatedDate" readonly>
                                                                   <input type="text" name="Id" id="kaizenIDD" class="form-control mb10" hidden >
                                                                   @*  <input type="hidden" id="loginIDuser" name="loginIDuser" value="@Accessor.HttpContext.Session.GetString("UserID")">  *@
                                                                    <input type="hidden" id="Userrole" data-role="@Accessor.HttpContext.Session.GetString("Userrole")">
                                                                        <span id="versionerror" class="text-danger error-message"></span>
                                                                </div>
                                                            </div>
                                                                <div class="col-sm-6" id="kaizenrefNo">
                                                                    <div class="form-group">
                                                                        <label>KAIZEN Ref.No<span class="mandatory">*</span></label>
                                                                        <input type="text" required="" name="refNo" id="refNo" class="form-control" readonly value="TEPL-MG-@Model.KaizenRefNo" data-toggle="popover" data-trigger="hover" data-placement="top" data-html="true" data-content='<p class="mt-1 text-center">IM/PP/05</p>' title="KAIZEN Ref.No [Example]">
                                                                        <span id="kaizenrefNoererror" class="text-danger error-message"></span>
                                                                    </div>
                                                                </div>
                                                                <div class="col-sm-6">
                                                                    <div class="form-group">
                                                                        <label>Doc No <span class="mandatory">*</span></label>
                                                                        <input type="text" name="docNo" id="docNo" class="form-control mb10" value="@Model.DocNo" @* readonly *@>
                                                                        <span id="docerror" class="text-danger error-message"></span>
                                                                    </div>
                                                                </div>

                                                            <div class="col-sm-6">
                                                                <div class="form-group">
                                                                    <label>Cost Centre<span class="mandatory">*</span></label>
                                                                    <input type="text" required="" name="codeCentre" id="codeCentre" class="form-control mb10 " value="@Model.CostCentre" data-toggle="popover" data-trigger="hover" data-placement="top" data-html="true" data-content='<p class="mt-1 text-center">00C</p>' title="Cost Centre [Example]">
                                                                        <span id="codecentererror" class="text-danger error-message"></span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                        </div>
                                    </div>
                                </div>
                                <!--3rdend-->
                            </div>
                            <!-- End Row -->
                        </div>
                        @* table2 *@
                        <div class="col-lg-12">
                            <div class="carddashed">
                                <div class="right-box-padding">
                                    <div class="read-content">

                                        <div class="card-body">
                                            <div class="row">
                                                <div class="col-sm-6">
                                                    <div class="form-group">
                                                        <label>Block<span class="mandatory">*</span></label> <br>
                                                        <div class="dropdown bootstrap-select ">
                                                            @* <select class="form-control selectized" name="plantname" id="plantname" required="" tabindex="-1">
                                                                <option value="" selected="selected">Select</option>
                                                                <!-- Add options here -->
                                                                <option value="option1">Option 1</option>
                                                                <option value="option2">Option 2</option>
                                                                <option value="option3">Option 3</option>
                                                            </select> *@

                                                            <select id="BlockName" class="form-control txt-width" name="UserType">
                                                                <option selected>Select</option>
                                                                 @if (Model.BlockList != null)
                                                                {
                                                                    foreach (var modellist in Model.BlockList)
                                                                    {
                                                                        <option value="@modellist.Id">@modellist.BlockName</option>
                                                                    }
                                                                } 
                                                                    
                                                            </select>
                                                            <span id="BlockError" class="text-danger error-message"></span>

                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="col-sm-6">
                                                    <div class="form-group">
                                                        <label>Kaizen Theme <span class="mandatory">*</span></label>
                                                        <input type="text" name="ktheme" id="ktheme" required="" class="form-control" value="@Model.KaizenTheme" data-toggle="popover" data-trigger="hover" data-placement="top" data-html="true" data-content='<p class="mt-1 text-center">Poka yoke in Rail placing</p>' title=" Kaizen Theme [Example] ">
                                                        <span id="themeError" class="text-danger error-message"></span>

                                                    </div>
                                                </div>


                                                <div class="col-sm-6">
                                                    <div class="form-group">
                                                        <label>Line/Machine <span class="mandatory">*</span></label>
                                                        <input type="text" name="teplplant" id="teplplant" required="" class="form-control" value="" data-toggle="popover" data-trigger="hover" data-placement="top" data-html="true" data-content='<p class="mt-1 text-center">IM 01 Process</p>' title="Block/Line/Machine/Others [Example]">
                                                        <span id="plantError" class="text-danger error-message"></span>
                                                    </div>
                                                </div>




                                                <div class="col-sm-6">
                                                    <div class="form-group">
                                                        <label>Suggested Kaizen ( Logical Correlation with root cause)</label>
                                                        <input type="text" required="" name="suggestedKaizen" id="suggestedKaizen" class="form-control" value="@Model.SuggestedKaizen" data-toggle="popover" data-trigger="hover" data-placement="top" data-html="true" data-content='<p class="mt-1 text-center">Provide stopper pin in Heating Fixture</p>' title="Suggested Kaizen [Example]">
                                                        <span id="suggestedKaizenError" class="text-danger error-message"></span>
                                                    </div>
                                                </div>
                                            </div>
                                            <!--row-->

                                        </div>
                                    </div>
                                </div>

                            </div>
                        </div>
                        @* endtable2 *@
                        @* table3 *@
                        <div class="col-lg-12">
                            <div class="carddashed">
                                <!-- <div class="card-body"> -->

                                <div class="right-box-padding">
                                    <div class="read-content">

                                        <div class="card-body">

                                            <div class="row">
                                                <div class="col-sm-6">
                                                    <div class="form-group">
                                                        <label>Problem Statement<span class="mandatory">*</span></label> <br>
                                                        <textarea class="textarea50" name="probstmt" id="probstmt" value="@Model.ProblemStatement" data-toggle="popover" data-trigger="hover" data-placement="top" data-html="true" data-content='<p class="mt-1 text-center justify-content-center">There is no POKA YOKE for Rail placing in Heating Fixture, due to this rail can place wrong direction and it possible for Mold damage and it affect part qualitity.</p>' title="Problem Statement [Example]"></textarea>
                                                        <span id="probstmtError" class="text-danger error-message"></span>
                                                    </div>
                                                </div>

                                                <div class="col-sm-6">
                                                    <div class="form-group">
                                                        <label>Counter measure( Engineering solution)<span class="mandatory">*</span></label> <br>
                                                        <textarea class="textarea50" name="countmeasur" id="countmeasur" value="@Model.CounterMeasure" data-toggle="popover" data-trigger="hover" data-placement="top" data-html="true" data-content='<p class="mt-1 text-center justify-content-center">Locating guide pin placed in fixture 3 places to avoid rail placing wrong orientation</p>' title="Counter measure [Example]"></textarea>
                                                        <span id="countmeasurError" class="text-danger error-message"></span>
                                                    </div>
                                                </div>
                                            </div>

                                        </div>

                                    </div>
                                </div>
                            </div>

                        </div>
                        @* Endtable3 *@
                    </div>

                </div>

            </div>

            <!-- End Accordion Item 1 -->
            <!-- Accordion item 2 -- start -->

            <div>

                <input class="ac-input" id="ac-2" name="accordion-1" type="checkbox" checked />
                <label class="ac-label" for="ac-2">Kaizen Image Details<i></i></label>
                <div class="article ac-content">
                    <div class="col-lg-12">
                        <div class="carddashed mt-2">
                            <div class="card-body">
                                <div class="right-box-padding">
                                    <div class="read-content">

                                        <div class="card-body">

                                            <div class="row">
                                                <div class="col-sm-6">
                                                    <div class="form-group">
                                                        <label>BEFORE</label> <br>
                                                        <div class="inpfilelabel" data-toggle="popover" data-trigger="hover" data-placement="top" data-html="true" data-content='<img src="/assets/img/tooltip-imgs/before-img.jpg" height="170" />' title="BEFORE [Example]">
                                                            <input id="attach_file_before" type="file" name="files" style="display: none;" onchange="previewImage(event, 'uploaded_before_image')">
                                                            <label for="attach_file_before" class="file-drag">
                                                                <div class="row upload-interface">
                                                                    <div class="col-sm-12">
                                                                        <img id="file-image-before" src="~/assets/img/file-upload-icon.png" alt="Preview" class="hidden mb-2">
                                                                        
                                                                        <div class="attachtitle" id="file-image-before-text">Click here to attach files</div>
                                                                    </div>
                                                                </div>
                                                            </label>
                                                            <span class="uploaded_image" id="uploaded_before_image"></span>
                                                        </div>
                                                        <span class="responsemessage_img_before"></span>
                                                    </div>
                                                </div>
                                                <div class="col-sm-6">
                                                    <div class="form-group">
                                                        <label>AFTER</label> <br>
                                                        <div class="inpfilelabel" data-toggle="popover" data-trigger="hover" data-placement="top" data-html="true" data-content='<img src="/assets/img/tooltip-imgs/after-img.jpg" height="170" />' title="AFTER [Example]">
                                                            <input id="attach_file_after" type="file" name="files_a" style="display: none;" onchange="previewImage(event, 'uploaded_after_image')">
                                                            <label for="attach_file_after" class="file-drag">
                                                                <div class="row upload-interface">
                                                                    <div class="col-sm-12">
                                                                        <img id="file-image-after" src="~/assets/img/file-upload-icon.png" alt="Preview" class="hidden mb-2">
                                                                        <div class="attachtitle" id="file-image-after-text">Click here to attach files</div>
                                                                    </div>
                                                                </div>
                                                            </label>
                                                            <span class="uploaded_image" id="uploaded_after_image"></span>
                                                        </div>
                                                        <span class="responsemessage_img_after"></span>
                                                    </div>
                                                </div>
                                            </div><!-- row -->

                                        </div>

                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                    @* //2nd *@
                    <div class="col-lg-12">
                        <div class="carddashed" id="carddash">
                            <div class="row mt-4" id="preview_area">
                                    <span class="uploaded_imagesmall" id="uploaded_additional_image"></span>
                                <div class="col-md-3 col-sm-4">
                                    <label class="mt-2">Add Additional Attachments</label> <br>
                                    <div class="inpfilelabel-attm mb-2 grayed-out" id="upload_area">
                                        <input id="additional_attachments" type="file" name="files" style="display: none;" multiple onchange="previewAdditionalImages(event)">
                                        <label for="additional_attachments" class="file-drag">
                                            <div class="upload-interface">
                                                <img id="file-image-additional" src="~/assets/img/file-upload-icon.png" alt="Preview" class="hidden mb-2">
                                                <div class="attachtitle mt-2" id="file-image-additional-text">Click here to attach files</div>
                                            </div> 
                                        </label>
                                    </div>   
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- accordion item 2 -- end -->

                </div>


            </div>

            <!-- End Accordion Section -->
            <!--startAccordin-3-->
            <div>
                <input class="ac-input" id="ac-3" name="accordion-1" type="checkbox" checked />
                <label class="ac-label" for="ac-3">Kaizen Member Details<i></i></label>
                <div class="article ac-content">
                    <div class="col-lg-12">
                        <div class="row">
                            @* <div class="col-sm-6"> *@
                            <div class="col-sm-12 col-lg-12">
                                <div class="carddashed mt-2">
                                    <div class="card-body">
                                        <div class="right-box-padding">
                                            <div class="read-content">
                                                <div class="card-body">
                                                    <div class="row">
                                                        <span class="col-sm-12">SAVINGS </span>
                                                        <hr style="border-top: 1px solid grey; width: 100%;">
                                                        <div class="col-sm-4 mt-3">
                                                            <div class="form-group">
                                                                <label>Yield</label>
                                                                <input type="text" name="yield1" id="yield1" value="@Model.Yield" required class="form-control" value="" title="">
                                                            </div>
                                                        </div>
                                                        <div class="col-sm-4 mt-3">
                                                            <div class="form-group">
                                                                <label>Cycle Time(Sec)</label>
                                                                    <input type="number" name="cycletime1" id="cycletime1" required class="form-control numeric-input" value="">
                                                            </div>
                                                        </div>
                                                        <div class="col-sm-4 mt-3">
                                                            <div class="form-group">
                                                                <label>Cost </label>
                                                                    <input type="number" name="cost1" id="cost1" required class="form-control numeric-input" value="" data-toggle="popover" data-trigger="hover" data-placement="top" data-html="true" data-content='<p class="mt-1 text-center">Rs 388186 / IM01 mold ( 13 IM1 molds for PP+BMB1 + BMB2)</p>' title="Cost [Example]">
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <!-- 2nd row -->
                                                    <div class="row">
                                                        <div class="col-sm-4">
                                                            <div class="form-group">
                                                                <label>Man power</label>
                                                                <input type="text" name="Man power" id="Manpower" required class="form-control" value="@Model.ManPower" value="" title="">
                                                            </div>
                                                        </div>
                                                        <div class="col-sm-4">
                                                            <div class="form-group">
                                                                <label>Consumables </label>
                                                                <input type="text" name="Consumables" id="Consumables" value="@Model.Consumables" required class="form-control" value="">
                                                            </div>
                                                        </div>
                                                        <div class="col-sm-4">
                                                            <div class="form-group">
                                                                <label>Others </label>
                                                                <input type="text" name="Others" id="Others" required class="form-control" value="@Model.Others" title="">
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <!-- end 2nd row -->
                                                    <!-- 3rd row -->
                                                    <div class="row">
                                                        <div class="col-sm-4">
                                                            <div class="form-group">
                                                                <label>Total Savings </label>
                                                                <input type="number" name="TotalSavings" id="TotalSavings" required class="form-control numeric-input" value="@Model.TotalSavings" data-toggle="popover" data-trigger="hover" data-placement="top" data-html="true" data-content='<p class="mt-1 text-center">5046418</p>' title="Total Savings [Example]">
                                                            </div>
                                                        </div>
                                                            <div class="col-sm-4 hidden123" id="approvedByIeContainer">
                                                                <div class="form-group">
                                                                    <label>Approved by (IE)</label>
                                                                    <div class="dropdown bootstrap-select">
                                                                        <select id="approvedbyIe" class="form-control txt-width" name="UserType">
                                                                            <option value="" selected>Select</option>
                                                                            @if (Model.IEDepartList != null)
                                                                            {
                                                                                foreach (var ieDepartList in Model.IEDepartList)
                                                                                {
                                                                                    <option value="@ieDepartList.EmpID">@ieDepartList.UserType</option>
                                                                                }
                                                                            }
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                            </div>


                                                            
                                                            <div class="col-sm-4 hidden123" id="approvedBySection">
                                                            <div class="form-group">
                                                                <label>Approved by (Accounts)</label>
                                                                    <input type="text" name="approvedbyAccount" id="approvedbyAccount" required class="form-control " value="@Model.AccountEmail" readonly >
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <!-- end 3rd row -->
                                                    <!-- 4th row -->
                                                   @*  <div class="row">
                                                        <div class="col-sm-8">
                                                            <div class="form-group">
                                                                <label>Approved by (Accounts)<span class="mandatory">*</span></label>
                                                                <input type="text" name="approvedbyAccount" id="approvedbyAccount"  required class="form-control" value="@Model.AccountEmail">
                                                            </div>
                                                        </div>
                                                    </div> *@
                                                    <!-- end 4th row -->
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            @* 2ndsection *@

                            <div class="col-sm-12 col-lg-12">

                                <div class="carddashed mt-2">

                                    <div class="card-body">

                                        <div class="table-responsive">

                                            <table class="table table-bordered mb10" id="idAddteammember">
                                                <thead>
                                                    <tr>
                                                            <th class="text-center" @* style="width: 200px;" *@>EMP ID</th>
                                                        <th class="text-center">Team Member Name</th>
                                                        <th class="text-center">Function</th>
                                                        <th class="text-center">Action</th>
                                                        
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr>
                                                            <td class="border-0 text-left"><input type="text" class="form-control mx-0 " id="IdMemberAdd" @* style="width: 200px; "*@></td>
                                                        <td class="border-0 text-left"><input type="text" class="form-control ml-1  " id="IdTeamMemberName" readonly> </td>
                                                            <td class="border-0 text-left"><input type="text" class="form-control ml-2 " id="IdFunction" readonly></td>
                                                        <td class="hidden-cell" style="display: none;"id="empGuid"></td>
                                                        <td class=" border-0 px-0" style="width:150px">
                                                         
                                                            <button id="teamAddBtn" class="btn btn-azure ml-3 mb-3 px-4">
                                                                <img src="~/assets/img/mingcute--add-line.png" />
                                                            </button>
                                                           
                                                            <button id="teamDelBtn" class="btn btn-danger ml-2 mb-3">
                                                                <img src="~/assets/img/tabler--trash.png" />
                                                            </button>
                                                        </td> 
                                                    </tr>

                                                </tbody>

                                            </table>

                                            <div class="table-container">
                                            <table id="tblteammemberResult" class="col-lg-10" >
                                                <tbody>
                                                        <tr>
                                                        </tr>
                                                </tbody>


                                            </table>
                                            </div>

                                        </div>

                                    </div>

                                </div>

                            </div>

                            @* endsection *@
                        </div>
                    </div>
                    @* <col-12Ended> *@
                    @* step2start *@
                    <div class="col-lg-12">
                        <div class="carddashed mt-2">
                            <div class="card-body">
                                <div class="right-box-padding">
                                    <div class="read-content">

                                        <div class="card-body">
                                            <div class="row">
                                                <div class="col-md-4">
                                                    <div class="form-group">
                                                        <label>Root Cause (Problem Phenomena)<span class="mandatory">*</span></label>
                                                        <br>
                                                            <textarea class="form-control" name="prob_stmt" data-toggle="popover" id="rootcauseProblem"></textarea>
                                                            <span id="rootProblemError" class="text-danger error-message"></span>
                                                            @* <select class="form-select" id="multiple-select-field"  data-placeholder="Select" multiple>
                                                            <option>4W1H</option>
                                                            <option>Fishbone Diag</option>
                                                            <option>Others</option>
                                                            <option>Pareto chart</option>
                                                            <option>Scatter Plot Diag</option>
                                                        </select> *@
                                                    </div>
                                                    <div class="form-group">
                                                        <label>Attachment</label>
                                                        <br>
                                                        <div class="inpfilelabel addattachfile mb-3" title="Attachment [Example]">
                                                            <input id="attach_file2" type="file" name="files" style="display: none;" onchange="previewImage(event, 'uploaded_attach2_image')">
                                                            <label for="attach_file2" class="file-drag">
                                                                <div class="row upload-interface">
                                                                    <div class="col-sm-12">
                                                                        <img id="file-image" src="~/assets/img/file-upload-icon.png" alt="Preview" class="hidden mb-2">
                                                                        <div class="attachtitle" id="file-image-text">Click here to attach files</div>
                                                                    </div>
                                                                </div>
                                                            </label>
                                                            <span class="uploaded_imagesmall" id="uploaded_attach2_image"></span>
                                                        </div>
                                                        <span class="responsemessage_img_attach"></span>
                                                    </div>

                                                    <div class="form-group">
                                                        <label>Root Cause Explanation</label>
                                                        <br>
                                                        <textarea class="form-control" name="prob_stmt" data-toggle="popover" id="rootcauseDetails" value="@Model.RootCauseDetails" data-trigger="hover" data-placement="top" data-html="true" data-content='<p class="mt-1 text-center">There is no POKA YOKE for Rail placing in Heating Fixture, due to this rail can place wrong direction and it possible for Mold damage and it affect part qualitity.</p>' title="Root Cause Explanation [Example]"></textarea>
                                                    </div>
                                                </div>
                                                <div class="col-md-4">
                                                    <div class="form-group">
                                                        <label>Brief explanation of present conditions<span class="mandatory">*</span></label>
                                                        <br>
                                                        <textarea class="textarea331" name="present_conditions" id="presentCondition" value="@Model.PresentCondition" data-toggle="popover" data-trigger="hover" data-placement="top" data-html="true" data-content='<p class="mt-1 text-center">There is no poka-yoke/ provision available in  Preheating Fixture.So, even if the rail orientation is changed during the placement by operator, it cant be easily noticed and potentially the rails would be placed in a mold with wrong orientation whci shall cause mold damage as well as defect part.</p>' title="Brief explanation [Example]"></textarea>
                                                            <span id="presentconditionsError" class="text-danger error-message"></span>
                                                    </div>
                                                </div>
                                                <div class="col-md-4">
                                                    <div class="form-group">
                                                        <label>Brief explanation of Improvements done<span class="mandatory">*</span></label>
                                                        <br>
                                                        <textarea class="textarea331" name="improvements_done" id="improvementsCompleted" value="@Model.ImprovementsCompleted" data-toggle="popover" data-trigger="hover" data-placement="top" data-html="true" data-content='<p class="mt-1 text-center">"This Poka Yoke improvement (stopper pin) is used to improve the rail locating guidance to avoid wrong direction placing.      Locator pin has been placed in fixture for bottom rail, left rail & right rail toavoid direction wrong loading and Mold damage as well as correction time saved.After implementing a poka yoke, operator cant able to place a rail in wrong orientation.
                                             This problem will be permanently eliminated.POKA YOKE Pin made in Inhouse with tool room mfg support."</p>' title="Brief explanation [Example]"></textarea>
                                                            <span id="ImprovementsError" class="text-danger error-message"></span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    @*
                    </div> *@



                    @* endpagedivs *@
                </div>
            </div>
            <!--EndAccordin-3-->
            <!--StartAccordin-4-->
            <div>

                <input class="ac-input" id="ac-4" name="accordion-2" type="checkbox" checked />
                <label class="ac-label" for="ac-4">
                    Kaizen Horizontal Deployment Details
                    <i></i>
                </label>
                <div class="article ac-content">
                    <form class="mt-2 pl-2">
                        <div class="control-group">
                            <label class="font-weight-bold">Horizontal Deployment</label>
                            <div class="controls">
                                <label class="radio inline">
                                    <input type="radio" name="horizontalDeployment" value="1" id="yesRadio"  />
                                    Yes
                                </label>
                                <label class="radio inline">
                                    <input type="radio" name="horizontalDeployment" value="0" checked id="noRadio"   />
                                    No
                                </label>
                            </div>
                        </div>
                    </form>
                    <div id="toggleContent" style="display: none;">
                    @* <div class="col-lg-12 col-sm-12"  > *@
                            <div class="col-lg-12"> 
                                <div class="carddashed mt-2">
                                    <div class="card-body">
                                        <div class="right-box-padding">
                                            <div class="read-content">
                                                <div class="card-body">
                                                    @* <div class="row"></div> *@
                                                    <span class="targetGrayed">
                                                        <div class="col-lg-12">
                                                            <div class="row">
                                                                <div class="col-lg-3 mt-2">
                                                                       
                                                            <label for="">In Other Machines within the cell<span class="mandatory">*</span></label>
                                                            <input class="form-control" type="text" id="InOtherMC">
                                                                    <span id="otherError" class="text-danger error-message"></span>
                                                        </div>
                                                        <div class="col-lg-3 mt-2">
                                                            <label for="">Within the Department in all the machine groups <span class="mandatory">*</span></label>
                                                            <input class="form-control" type="text" id="withinDept">
                                                                    <span id="withinError" class="text-danger error-message"></span>
                                                        </div>
                                                       @*  </div>
                                                        
                                                        <div class="row"> *@
                                                            <div class="col-lg-3 mt-2">
                                                                <label for="">In Other Dept/ Other Location<span class="mandatory">*</span></label>
                                                                <input class="form-control" type="text" id="InotherDept">
                                                                    <span id="InotherError" class="text-danger error-message"></span>
                                                            </div>
                                                            <div class="col-lg-3 mt-2">
                                                                <label for="">Any other Relevant Points<span class="mandatory">*</span></label>
                                                                <input class="form-control" type="text" id="Otherpoints">
                                                                    <span id="OtherpointsError" class="text-danger error-message"></span>
                                                            </div>
                                                        </div>
                                                        </div>

                                                    </span>
                                                </div>
                                            </div>

                                        </div>
                                    </div>
                                </div>
                                </div>
                            

                            @* 2ndsection *@

                            @* <div class="col-sm-12 col-lg-12">

                                <div class="carddashed mt-2">

                                    <div class="card-body targetGrayed">
                                        <label>
                                            Scope and Plan for Horizontal Deployment
                                        </label>

                                        <div class="table-responsive" id="table2">

                                            <table class="table table-bordered mb10" id="tblDeployment">

                                                <thead>

                                                    <tr>

                                                     
                                                        <th class="text-center">M/C</th>

                                                        <th class="text-center">Target Date</th>

                                                        <th class="text-center">Responsibility</th>

                                                        <th class="text-center">Status</th>

                                                        <th class="text-center">Action</th>

                                                    </tr>

                                                </thead>

                                                <tbody>

                                                    <tr>

                                                      
                                                        <td class="border-0 "><input type="text" class="form-control" id="txtMc"></td>

                                                        <td class="border-0"><input type="date" class="form-control" id="txtTargetDate"></td>

                                                        <td class="border-0 "><input type="text" class="form-control" id="txtResponsibility"></td>

                                                        <td class="border-0 "><input type="text" class="form-control" id="txtStatus"></td>

                                                     
                                                        <td class=" border-0 px-0" style="width:150px">
                                                          
                                                                <button id="btnAddDeployment" class="btn btn-azure ml-3 mb-3 px-4">
                                                                    <img src="~/assets/img/mingcute--add-line.png" />
                                                                </button>

                                                                <button id="btnDeleteDeployment" class="btn btn-danger ml-2 mb-3">
                                                                    <img src="~/assets/img/tabler--trash.png" />
                                                                </button>
                                                        </td>
                                                    </tr>

                                                </tbody>

                                            </table>
                                                <div class="table-container">
                                            <table id="tblDeploymentrResult" class="col-lg-12">
                                                <tbody>
                                                            <tr>
                                                            </tr>
                                                </tbody>
                                            </table>
                                            </div>

                                        </div>

                                    </div>

                                </div>

                            </div> *@

                            @* endsection *@

                    </div>

                </div>
            </div>

            <!--EndAccordin-4-->
            <!--StartAccordin-5-->
            <div>

                <input class="ac-input" id="ac-5" name="accordion-2" type="checkbox" checked />
                <label class="ac-label" for="ac-5">Kaizen Approver Details<i></i></label>
                <div class="article ac-content">
                    <div class="col-lg-12">
                        <div class="row">
                            <div class="col-lg-4">
                                <div class="carddashed mt-2">
                                    <div class="card-body">
                                        <div class="right-box-padding">
                                            <div class="read-content">
                                                <div class="form-group ">
                                                    <label>Benefits (P,Q,C,S,D,M,E)<span class="mandatory">*</span></label>
                                                    <textarea class="textarea331" name="present_conditions" id="benefit" value="@Model.BenefitArea" data-toggle="popover" data-trigger="hover" data-placement="top" data-html="true" data-content='<p class="mt-1 text-center">"Q - This poka yoke will make sure the rail orientation is always right.S -
                                                                 This will ensure and prevent mold or part damage and improves mold safety.M- It will increase MTTR & MTBF (as of now no data).
                                                               Since IM1 is citical for further downstream process, this will have direct impact of unplanned downtime (reduction) in downstream process till final assembly."</p>' title="Benefits [Example]"></textarea>
                                                        <span id="BenefitsError" class="text-danger error-message"></span>
                                                </div>
                                            </div>
                                            </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-8">
                                <div class="carddashed mt-2">
                                    <div class="card-body">
                                        <div class="right-box-padding">
                                            <div class="read-content">
                                                <div class="form-group ">
                                                    <table class="table table-bordered" style="height: 50vh;">

                                                        <thead>

                                                            <tr>

                                                                <th class="border-0"></th>

                                                                <th class="border-0">KAIZEN Originated By</th>

                                                                <th class="border-0">KAIZEN Approved By</th>
                                                                @* <th class="border-0">KAIZEN Confirmed By</th> *@


                                                            </tr>

                                                        </thead>

                                                        <tbody>

                                                            <tr>

                                                                <td class="text-center align-middle py-5">
                                                                    Name
                                                                </td>

                                                                <td class="align-middle align-items-center justify-content-center col-3">
                                                                        <input type="text" class="mx-auto form-control col-9" id="name" name="name" value="@Model.name" readonly>
                                                                    <input type="text" class="mx-auto form-control col-9" id="createdBy" name="createdBy" value="@Model.EmpId" hidden>
                                                                </td>
                                                                <td class="align-items-center d-flex justify-content-center h-100">
                                                                    <select name="DRIApprovedBy" id="driapprovedby" class="form-control col-9">
                                                                        @* <option>321256 - Pankaj Singh</option>  *@
                                                                         @foreach (var manager in managerList)
                                                                        {
                                                                            <option value="@manager.MgrId">@manager.MgrId-@manager.ManagerName</option>
                                                                        }

                                                                    </select>
                                                                </td>
                                                                @* <td class="align-middle align-items-center justify-content-center col-3">
                                                                    <input type="text" class="mx-auto form-control col-4">
                                                                </td> *@


                                                            </tr>
                                                            <tr>

                                                                <td class="text-center align-middle py-5">
                                                                    Dept
                                                                </td>

                                                                <td class="align-middle align-items-center justify-content-center col-3">
                                                                        <input type="text" class="mx-auto form-control col-9" id="DomainId" name="DomainId" value="@Model.Domain - @Model.Department" readonly>
                                                                </td>
                                                                <td class="align-items-center d-flex justify-content-center h-100">
                                                                        <input name="DeptId" id="DeptId" class="form-control col-9" value="@Model.Domain - @Model.Department" readonly>
                                                              @*   <button class="lol">Bt</button> *@
                                                                    </td>
                                                               @*  <td class="align-middle align-items-center justify-content-center col-3">
                                                                    <input type="text" class="mx-auto form-control col-4">
                                                                </td> *@

                                                            </tr>
                                                            <tr>

                                                                <td class="text-center align-middle py-5">
                                                                    Date
                                                                </td>
                                                                @{
                                                                     DateTime parsedDate;
                                                                     bool isValidDate = DateTime.TryParse(Model.OriginatedDate, out parsedDate);
                                                                }
                                                                <td class="align-middle align-items-center justify-content-center col-3">
                                                                    <input type="text" class="mx-auto form-control col-9" id="CDeta" name="CDate" value="@parsedDate.ToString("dd/MM/yyyy")" readonly>

                                                                </td>
                                                                <td class="align-items-center d-flex justify-content-center h-100">
                                                                    <input name="driapproveddate" type="date" id="driapproveddate" class="form-control col-9">
                                                                </td>
                                                                @* <td class="align-middle align-items-center justify-content-center col-3">
                                                                    <input type="text" class="mx-auto form-control col-4">
                                                                </td> *@

                                                            </tr>



                                                        </tbody>

                                                    </table>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div> @* rowend *@
                    </div> @* col-12end *@

                    <div class="col-lg-12">
                        <div class="carddashed mt-2">
                            <div class="card-body">
                                <div class="right-box-padding">
                                    <div class="read-content">
                                        <div class="form-group ">
                                            <p>
                                                FORMAT/ Ver,No : TEPL-IE-C-FR-0005/01
                                                Tata Electronics Private Limited
                                            </p>
                                                <div class="card-body float-right mt-2" id="saveItButton">
                                                    <button class="btn btn-warning" id="btnSaveKaizen">Save It</button>
                                                    <button class="btn btn-azure" id="btnSubmitKaizen">Submit to DRI</button>
                                                </div>

                                                <div class="card-body float-right mt-2" id="">
                                                    <button class="btn btn-warning" id="btnUpdateKaizen">Save It</button>
                                                    <button class="btn btn-azure" id="btnSubmittedStatus">Submit to DRI</button>
                                                </div>


                                        </div>                                                                                
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!--EndAccordin-5-->
            @* acordion6 *@
            <div id="approvers">

                <input class="ac-input" id="ac-6" name="accordion-1" type="checkbox" checked />
                <label class="ac-label" for="ac-6">Approvers <i></i></label>
                <div class="article ac-content">
                    <div class="col-lg-12 py-2" >
                         <div class="row">
                                <!-- Image Sanitization Card -->
                                <div id="ImageApprover" class="col-md-4" style="display: none;">
                                    <div class="card carddashed">
                                        <div class="card-header">Image Sanitization</div>
                                        <div class="card-body">
                                            <div><strong>Name :</strong> <span id="imageaprName"></span></div>
                                            <div><strong>Status :</strong> <span id="imagestatusid"></span></div>
                                        </div>
                                    </div>
                                </div>
                         </div>
                    <div class="row">
                            <!-- DRI Card -->
                            <div id="DRIDept" class="col-md-4" style="display: none;">
                                <div class="card carddashed">
                                    <div class="card-header">DRI</div>
                                    <div class="card-body">
                                        <div><strong>Name :</strong> <span id="driName"></span></div>
                                        <div><strong>Email :</strong> <span id="driEmail"></span></div>
                                        <div><strong>Department :</strong><span id="dDom"></span>- <span id="dDept"></span></div>
                                        <div><strong>Status :</strong> <span  id="dristatusid"></span></div>
                                        <div><strong>Rejected Reason :</strong> <span id="driRejectedReason"></span></div>
                                        <div><strong>Approved Date :</strong> <span id="driDateTime"></span></div>
                                    </div>
                                </div>
                            </div>
                            <!-- IE Dept Card -->
                            <div class="col-md-4" id="IEDept" style="display: none;">
                                <div class="card  carddashed">
                                <div class="card-header">IE Dept</div>
                                <div class="card-body">
                                        <div><strong>Name :</strong> <span id="ieName"></span></div>
                                        <div><strong>Email :</strong> <span id="ieEmail"></span></div>
                                        <div><strong>Department :</strong><span id="ieeDom"></span>-<span id="ieeDept"></span></div>
                                        <div><strong>Status :</strong> <span id="iestatusid"></span></div>
                                        <div><strong>Rejected Reason :</strong> <span id="ieRejectedReason"></span></div>
                                        <div><strong>Approved Date :</strong> <span id="ieDateTime"></span></div>
                                </div>
                            </div>
                        </div>
                        <!-- Finance Dept Card -->
                            <div id="FinanceDept" class="col-md-4" style="display: none;">
                                <div class="card carddashed">
                                <div class="card-header">Finance Dept</div>
                                <div class="card-body">
                                        <div><strong>Name :</strong> <span id="finName"></span></div>
                                        <div><strong>Email :</strong> <span id="finEmail"></span></div>
                                        <div><strong>Department :</strong> <span id="finDom"></span>-<span id="finDept"></span></div>
                                        <div><strong>Status :</strong> <span  id="financestatusid"></span></div>
                                        <div><strong>Rejected Reason :</strong> <span id="finRejectedReason"></span></div>
                                        <div><strong>Approved Date :</strong> <span id="finDateTime"></span></div>
                                </div>
                            </div>
                        </div>
                   
                           
                        </div>
                      @*   <div class="col-sm-12" id="Editbtn">
                            <label>Would You Like To Edit Kaizen :</label>
                                <button id="scrollToTopBtn" class="btn btn-warning" onclick="scrollToTop()">Edit</button>
                            </div> *@
                            <div class="col-sm-12" id="imagelabel">
                            <label>Would You Like To Approve Kaizen Image and move it to Dri Approval </label>
                                                   
                            </div>
                        <div class="col-sm-12 " id="Aprrovalbtn">
                           
                            <div class="card-body float-left">
                                <div>
                                     <label class="btn btn-success" id="waitingapproval" >Waiting for Your Approval</label>
                                    <label class="btn btn-success" id="waitingimage">Waiting for Image Sanitation</label>
                                </div>
                                <button class="btn btn-primary" id="ApprovButton">Approve</button>
                                <button class="btn btn-danger" data-toggle="modal" data-target=".bd-example-modal-lg">Reject</button>                             
                                <button class="btn btn-warning" id="Aprrovalbtnhold">Hold </button>
                            </div>
                        </div>

                        <div class="modal fade bd-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
                            <div class="modal-dialog modal-md">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <div class="modal-title">Please Enter the Reason for Rejection</div>
                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                            <span aria-hidden="true">&times;</span>
                                        </button>
                                    </div>

                                    <div class="modal-body">
                                        <textarea class="col-lg-12"id="RejectionReason"></textarea>
                                    </div>
                                    <button class="btn btn-danger" id="rejectButton">Reject</button>
                                </div>
                            </div>
                        </div>
                </div>
            </div>
           </div>
        </div>
        @* containerdivs *@
    </div>
    </div>
</div>

@* <div class="col-sm-12 ">
    <div class="card-body float-right" id="saveItButton">
        <button class="btn btn-warning" id="btnSaveKaizen" >Save It</button>
        <button class="btn btn-azure" id="btnSubmitKaizen">Submit to DRI</button>
    </div>
</div> *@
<!-- Styles -->


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/select2-bootstrap-5-theme@1.3.0/dist/select2-bootstrap-5-theme.min.css" crossorigin="anonymous" />
<!-- Or for RTL support -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/select2-bootstrap-5-theme@1.3.0/dist/select2-bootstrap-5-theme.rtl.min.css" crossorigin="anonymous" />
<!-- Scripts -->
<script src="https://code.jquery.com/jquery-3.5.1.min.js" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js" crossorigin="anonymous"></script>
<script src="~/assets/js/custom/html2pdf.bundle.js"></script>

<script>
    
    $(document).ready(function () {
    var dateInput = document.getElementById('CDeta');
    var dateValue = dateInput.value;
    
    if (dateValue) {
        var parts = dateValue.split('-');
        if (parts.length === 3) {
            var formattedDate = parts[0] + '/' + parts[1] + '/' + parts[2];
            dateInput.value = formattedDate;
                console.log("Converted Date= "+formattedDate)
        } else {
            console.error("Date format is not correct");
        }
    }
});


    function loadModalContent() {
         
        debugger;
        $.get('@Url.Action("KaizenModalPopupPartial", "CreateKaizen")', function (data) {
            $('#modalPlaceholder').html(data);
            $('#sampleKaizenModal').modal('show');
        });
    }
    // function scrollToTop() {
    //     var scroll_pos = $(window).scrollTop()
    // }
    // function generateGUID() {
    //     function s4() {
    //         return Math.floor((1 + Math.random()) * 0x10000).toString(16).substring(1);
    //     }
    //     return s4() + s4() + '-' + s4() + '-' + s4() + '-' + s4() + '-' + s4() + s4() + s4();
    // }
    // function updateGUID() {
    //     let guid = generateGUID();
    //     document.getElementById('kaizenid').value = guid;
    // }
    // window.onload = function () {
    //     updateGUID();
    // }

    //Download PDF Start
    $('#printPDF').click(function () {
        var element = document.getElementById('downloadDiv');
        html2pdf().from(element).set({
            margin: [30, 10, 5, 10], //top,left,buttom,right
            pagebreak: { avoid: 'tr' },
            jsPDF: { orientation: 'landscape', unit: 'pt', format: 'letter', compressPDF: true }
        }).save()
    });
  
   
    $('#backbtn').click(function () {
       window.location = "/SubmittedKaizen/ViewKaizen"
     
    });
    //Download PDF End

    $(document).ready(function () {

        var userRole = $('#Userrole').data('role');
     
        function handleButtonClick(enumValue, RejectionReason='') {
            $.ajax({
                url: '/CreateKaizen/getstatus',
                type: 'POST',
                contentType: 'application/json',
                data: JSON.stringify({
                    approvalStatus: enumValue,
                    RejectionReason: RejectionReason,
                    
                }),

                success: function (response) {
                    swal("Status Updated").then(function () {
                        // window.location.reload();
                        window.location = "/SubmittedKaizen/ViewKaizen"
                    });

                },
                error: function (error) {
                    swal("some error");
                }
            });
        }
        $('#rejectButton').click(function () {
            let enumValue;
            var RejectionReason = $('#RejectionReason').val();
            
            switch (userRole) {
                case 'IE DEPT':
                    enumValue = 7; // IERejected
                    break;
                case 'FINNACE':
                    enumValue = 9; // FinanceRejected
                    break;
                case 'MANAGER':
                    enumValue = 5; //DriRejected
                    break;
                case 'IMAGE APPROVER':
                    enumValue = 3; // ImageRejected
                    break;
                default:
                    enumValue = 10; // Pending or some default value
                    break;
            }
            handleButtonClick(enumValue, RejectionReason);
        });

        $('#ApprovButton').click(function () {
            let enumValue;
            switch (userRole) {
                case 'IE DEPT':
                    enumValue = 6; // IEApproved
                    break;
                case 'FINNACE':
                    enumValue = 8; // FinanceApproved
                    break;
                case 'MANAGER':
                    enumValue = 4; // ImageApproved
                    break;
                case 'IMAGE APPROVER':
                    enumValue = 2; // ImageApproved
                    break;
                default:
                    enumValue = 0; // Saved or some default value
                    break;
            }
            handleButtonClick(enumValue);
        });

        $('#Aprrovalbtnhold').click(function () {
            let enumValue;
            switch (userRole) {
                case 'IE DEPT':
                    enumValue = 12; // Pending or some specific hold value
                    break;
                case 'FINNACE':
                    enumValue = 13; // Pending or some specific hold value
                    break;
                case 'MANAGER':
                    enumValue = 11; // Pending or some specific hold value
                    break;               
                default:
                    enumValue = 10; // Pending or some default value
                    break;
            }
            handleButtonClick(enumValue);
        });
    });

    window.onload = function () {
        var userRole = $('#Userrole').data('role');

    function showHideDivsByRole(userRole) {
        $('#IEDept').hide();
        $('#FinanceDept').hide();
        $('#DRIDept').hide();
        $('#ImageApprover').hide();
        $('#Aprrovalbtn').hide();
        $('#Editbtn').hide();
            $('#waitingapproval').hide();
            $('#waitingimage').hide();
            $('#imagelabel').hide();
            $('#printPDF').hide(); 
            $('#btnUpdateKaizen').hide();
            $('#btnSubmittedStatus').hide();

            $('#backbtn').hide();
            $('#Srno').hide();
            $('#kaizenrefNo').hide();


            switch (userRole) {
                case 'IE DEPT':
                    $('#DRIDept').show();
                $('#Aprrovalbtn').show();
                $('#waitingapproval').show();
                break;
                case 'FINNACE':
                    $('#DRIDept').show();
                $('#IEDept').show();
                $('#Aprrovalbtn').show();
                $('#waitingapproval').show();
                break;
                case 'MANAGER':
                    $('#ImageApprover').show();
                    $('#Editbtn').show();
                    $('#Aprrovalbtn').show();
                    $('#waitingapproval').show();
                break;
                case 'ADMIN':
                    break;
                case 'IMAGE APPROVER':
                    $('#waitingimage').show();
                    $('#imagelabel').show();
                    $('#Aprrovalbtn').show();
                $('#Aprrovalbtnhold').hide();
                 break;
              
        }
    }
   
        showHideDivsByRole(userRole);
    }
    document.addEventListener('DOMContentLoaded', function () {
        var approversDiv = document.getElementById('approvers');
        if (approversDiv) {
            var editKaizenData = sessionStorage.getItem('editKaizen');
         
            
            if (editKaizenData) {
                approversDiv.style.display = 'block';
            } else if (editKaizenData) {
                approversDiv.style.display = 'none'; 
            }
        }
    });
   
    document.getElementById('yesRadio').addEventListener('change', function () { 
        
        document.getElementById('toggleContent').style.display = 'block';
    });

    document.getElementById('noRadio').addEventListener('change', function () {
        document.getElementById('toggleContent').style.display = 'none';
       
       
    });
    // $('#multiple-select-field').select2({
    //     theme: "bootstrap-5",
    //     width: $(this).data('width') ? $(this).data('width') : $(this).hasClass('w-100') ? '100%' : 'style',
    //     placeholder: $(this).data('placeholder'),
    //     closeOnSelect: false,
    // });
    function toggleTableGrayedOut(grayOut) {
        if (grayOut) {
            $('.targetGrayed').addClass('grayed-out');
        } else {
            $('.targetGrayed').removeClass('grayed-out');
        }
    }

    toggleTableGrayedOut($('#N').is(':checked'));
    $('input[type="radio"][name="onnOff"]').change(function () {
        var isChecked = $(this).prop('id') === 'N';
        toggleTableGrayedOut(isChecked);
    });

    jQuery("#IdMemberAdd").blur(function () {
        var EmpId = $('#IdMemberAdd').val();
        $.ajax({
            type: 'POST',
            url: '/CreateKaizen/GetTeamMemberDetails',
            dataType: "json",
            data: {
              EmpId: EmpId
            },
            success: function (result) {
                $("#IdTeamMemberName").val(result.name);
                $("#IdFunction").val(result.domain);
                $("#empGuid").val(result.empguid);
               
            },
            error: function (error) {
                swal('Unable to Find the Team Member Details - Please Check the logs');
                // Handle errors (if needed)
                // console.error('Error:', error);
            }
        });
    });

    // $("#cycletime1").change(function () {
    //     $("#approvedbyIE").removeAttr("disabled");
    // });

    // $("#cost1").change(function () {
    //     $("#approvedbyIE").removeAttr("disabled");
    //     var varlength = $("#cost1").val();

    //     if (varlength>=100000)
    //     {
    //         $("#approvedbyAccount").removeAttr("disabled");
    //     }

    // });


    
    $("#teamAddBtn").click(function () {
        var mytable = document.getElementById("tblteammemberResult");
        var rows = mytable.rows.length;
        if (rows < 7) {
        var r = mytable.insertRow(rows);
        
        var c1 = r.insertCell(0);
        var c2 = r.insertCell(1);
        var c3 = r.insertCell(2);
        var c4 = r.insertCell(3);
        var c5 = r.insertCell(4);
        

        var checkbox = document.createElement("input");
        var empId = document.createElement("input");
        var teamMemberName = document.createElement("input");
        var FunctionName = document.createElement("input");
            var Empguid = document.createElement("input");

        checkbox.type = "checkbox";
        empId.type = "text"; 
        empId.value = $("#IdMemberAdd").val();
            empId.readOnly = true;
        empId.className = "input-width";
        teamMemberName.type = "text";
        teamMemberName.value = $("#IdTeamMemberName").val();
        teamMemberName.className = "input-width";
        teamMemberName.readOnly = true;
        FunctionName.className = "input-width";
        FunctionName.type = "text";
        FunctionName.readOnly = true;
        
        FunctionName.value = $("#IdFunction").val();
        FunctionName.className = "input-width";
         Empguid.type = "hidden";
        Empguid.value = $("#empGuid").val();
        c1.appendChild(checkbox);      
        c2.appendChild(empId);
        c3.appendChild(teamMemberName);
        c4.appendChild(FunctionName);
        c5.appendChild(Empguid);
        //value added for list start
        c2.value = $("#IdMemberAdd").val();
        c3.value = $("#IdTeamMemberName").val();
        c4.value = $("#IdFunction").val();
        c5.value = $("#empGuid").val();
        //value added for list end
        c1.style.width = '5%';
        c2.style.width = '31%';
        c3.style.width = '32%';
        c4.style.width = '32%';
        $("#IdMemberAdd").val("");
        $("#IdTeamMemberName").val("");
        $("#IdFunction").val("");
            $("#empGuid").val("");
      }
      else
      {
            swal("Maximum Of Six Rows Only");
      }

    });

    $("#teamDelBtn").click(function () {

        var mytable = document.getElementById("tblteammemberResult");
        var rows = mytable.rows.length;
        for (var i = rows - 1; i > 0; i--) {
            if (mytable.rows[i].cells[0].children[0].checked) {
                mytable.deleteRow(i);
            }
        }
    });
   
    $("#btnAddDeployment").click(function () {
        
        var mytable = document.getElementById("tblDeploymentrResult");
        var rows = mytable.rows.length;

        if (rows < 7) {
        var r = mytable.insertRow(rows);
        var Ad1= r.insertCell(0);
        var Ad2 = r.insertCell(1);
        var Ad3 = r.insertCell(2);
        var Ad4 = r.insertCell(3);
        var Ad5 = r.insertCell(4);
        


        var checkbox = document.createElement("input");
        var Sno = document.createElement("input");
        var mc = document.createElement("input");
        var targetDate = document.createElement("input");
        var responsibility = document.createElement("input");
        var status = document.createElement("input");


        checkbox.type = "checkbox";
        Sno.type = "text";
        Sno.value = $("#txtNo").val();
        Sno.className = "input-width";
            Sno.readOnly = true;
            mc.type = "text";
        mc.value = $("#txtMc").val();
        mc.className = "input-width";
            mc.readOnly = true;
            targetDate.type = "date";
        targetDate.value = $("#txtTargetDate").val();
        targetDate.className = "input-width";
            targetDate.readOnly = true;
            responsibility.type = "text";
        responsibility.value = $("#txtResponsibility").val();
        responsibility.className = "input-width";
            responsibility.readOnly = true;
        status.type = "text";
        status.value = $("#txtStatus").val();
        status.className = "input-width";
            status.readOnly = true;

            Ad1.appendChild(checkbox);
       
        Ad2.appendChild(mc);
        Ad3.appendChild(targetDate);
        Ad4.appendChild(responsibility);
        Ad5.appendChild(status);

        Ad2.value = $("#txtMc").val();
        Ad3.value = $("#txtTargetDate").val();
        Ad4.value = $("#txtResponsibility").val();
        Ad5.value = $("#txtStatus").val();

        Ad2.className = 'col-cd-2';
        Ad3.className = 'col-cd-4';
        Ad4.className = 'col-cd-3';
        Ad5.className = 'col-cd-3';
      
        $("#txtMc").val("");
        $("#txtTargetDate").val("");
        $("#txtResponsibility").val("");
        $("#txtStatus").val("");
        }
        else{
            swal("Maximum Of Six Rows Only");
        }
    });

    $("#btnDeleteDeployment").click(function () {

        var mytable = document.getElementById("tblDeploymentrResult");
        var rows = mytable.rows.length;
        for (var i = rows - 1; i > 0; i--) {
            if (mytable.rows[i].cells[0].children[0].checked) {
                mytable.deleteRow(i);
            }
        }
    });
 //FinanceApprovedBy
    $(document).ready(function () {
        $('#cost1').on('input', function () {
            var costValue = $(this).val();
            var approvedBySection = $('#approvedBySection');
            if (costValue.length >= 6) {
                approvedBySection.addClass('show');
            } else {
                approvedBySection.removeClass('show');
            }
        });
    });
 //IEApprovedBy
    $(document).ready(function () {
        function toggleVisibility() {
            var cycleTime = $('#cycletime1').val().trim();
            var manPower = $('#Manpower').val().trim();
            var inputsFilled = cycleTime !== '' || manPower !== '';
            var container = $('#approvedByIeContainer');
            container.toggleClass('hidden123', !inputsFilled);
            container.toggleClass('show', inputsFilled);
        }
        toggleVisibility();
        $('#cycletime1, #Manpower').on('input', toggleVisibility);
    });

 //accept numbers
    document.querySelectorAll('.numeric-input').forEach(function (element) {
        element.addEventListener('input', function (e) {
            this.value = this.value.replace(/[^0-9]/g, '');
        });
    });
 //originDate < approveddate
    $(document).ready(function () {
        function updateMinDate() {
            var originDate = $('#CDeta').val().split('-').reverse().join('-');
            $('#driapproveddate').attr('min', originDate);
        }
        $('#CDeta').add('#driapproveddate').on('change', function () {
            var originDate = new Date($('#CDeta').val().split('-').reverse().join('-'));
            var approvedDate = new Date($('#driapproveddate').val());
            if (this.id === 'CDeta') {
                updateMinDate();
            } else if (approvedDate <= originDate) {
                $('#driapproveddate').val('');
                swal('Approved date must be greater than Originated date.');
            }
        });
        updateMinDate(); 
    });
 //emptable
    $(document).ready(function () {
        function toggleButtons() {
            var input1 = $('#IdMemberAdd').val().trim();
            var inputsFilled = input1.length >= 6;
            var checkboxChecked = $('input[type="checkbox"]:checked').length > 0;
            $('#teamAddBtn').toggleClass('grayed-out', !inputsFilled).prop('disabled', !inputsFilled);
            $('#teamDelBtn').toggleClass('grayed-out', !checkboxChecked).prop('disabled', !checkboxChecked);
        }
        toggleButtons();
        $(document).on('input', '#IdMemberAdd, #IdTeamMemberName, #IdFunction', toggleButtons);
        $(document).on('change', 'input[type="checkbox"]', toggleButtons);
        $('#teamAddBtn, #teamDelBtn').on('click', function () {
            $('#teamAddBtn, #teamDelBtn').addClass('grayed-out').prop('disabled', true);
        });
    });

    function ValidateForm() {
        var isValid = true;
        var firstInvalidField = null; 

        $("#docNo").css("border-color", "red");
        $("#docerror").text("");
        $(".error-message").text("");

        $("#versionNo").css("border-color", "red");
        $("#versionerror").text("");
        $(".error-message").text("");

        $("#codeCentre").css("border-color", "red");
        $("#codecentererror").text("");
        $(".error-message").text(""); 
        
        $("#refNo").css("border-color", "red");
        $("#kaizenrefNoererror").text("");
        $(".error-message").text(""); 

        $("#BlockName").css("border-color", "red");
        $("#Blockerror").text("");
        $(".error-message").text("");

        $("#ktheme").css("border-color", "red");
        $("#themeError").text("");
        $(".error-message").text("");

        $("#teplplant").css("border-color", "red");
        $("#teplplantError").text("");
        $(".error-message").text("");

        $("#probstmt").css("border-color", "red");
        $("#probstmtError").text("");
        $(".error-message").text("");

        
        $("#countmeasur").css("border-color", "red");
        $("#countmeasurError").text("");
        $(".error-message").text("");

        $("#rootcauseProblem").css("border-color", "red");
        $("#rootProblemError").text("");
        $(".error-message").text("");

        $("#presentCondition").css("border-color", "red");
        $("#presentconditionsError").text("");
        $(".error-message").text("");

        $("#improvementsCompleted").css("border-color", "red");
        $("#ImprovementsError").text("");
        $(".error-message").text("");

        $("#InOtherMC").css("border-color", "red");
        $("#otherError").text("");
        $(".error-message").text(""); 

        $("#withinDept").css("border-color", "red"); 
        $("#withinError").text("");
        $(".error-message").text("");
                 
        $("#InotherDept").css("border-color", "red");
        $("#InotherError").text("");
        $(".error-message").text("");

        $("#Otherpoints").css("border-color", "red");
        $("#OtherpointsError").text("");
        $(".error-message").text("");

        $("#benefit").css("border-color", "red");
        $("#BenefitsError").text("");
        $(".error-message").text("");

        var benifitarea = [];
        $('#checkboxform1 input[type=checkbox]:checked').each(function () {
            benifitarea.push($(this).val());
        });
        var blockNameValue = $("#BlockName").val();
        var themeName = $("#ktheme").val();
        var plantName = $("#teplplant").val();
        var problemName = $("#probstmt").val();
        var counterMeasuremName = $("#countmeasur").val();
        var documentNo = $("#docNo").val();
        var versionNo = $("#versionNo").val();
        var codeCentre = $("#codeCentre").val();
        var refNo = $("#refNo").val();
        var Yield = $("#yield1").val();
        var CycleTime = $("#cycletime1").val();
        var Cost = $("#cost1").val();
        var rootcauseproblem = $("#rootcauseProblem").val();
        var PresentConditions = $("#presentCondition").val();
        var Improvements = $("#improvementsCompleted").val();
        var Benifits = $("#benefit").val();
        var addedTeamMembers = [];
        
        $('#tblteammemberResult tbody tr').each(function () {
            var row = $(this);
            var memberDetails = {};
            if (row.find("TD").eq(2).val() != undefined) {
                memberDetails.EmpId = row.find("TD").eq(4).val();
                memberDetails.TeamMemberName = row.find("TD").eq(2).val();
                memberDetails.FunctionName = row.find("TD").eq(3).val();
                addedTeamMembers.push(memberDetails);
            }
        });
        if (documentNo === "") {
            $("#docNo").css("border-color", "red");
            $("#docerror").text("Doc No is required.");
            if (!firstInvalidField) firstInvalidField = "#docNo";
            isValid = false;
        }
        if (versionNo === "") {
            $("#versionNo").css("border-color", "red");
            $("#versionerror").text("Version No is required.");
            if (!firstInvalidField) firstInvalidField = "#versionNo";
            isValid = false;
        }
        if (codeCentre === "") {
            $("#codeCentre").css("border-color", "red");
            $("#codecentererror").text("Cost Center is required.");
            if (!firstInvalidField) firstInvalidField = "#codeCentre";
            isValid = false;
        }
        if (refNo === "") {
            $("#refNo").css("border-color", "red");
            $("#kaizenrefNoererror").text("Ref No is required.");
            if (!firstInvalidField) firstInvalidField = "#refNo";
            isValid = false;
        }
        if (blockNameValue === "Select") {
            $("#BlockName").css("border-color", "red");
            $("#BlockError").text("Please Select Block.");
            if (!firstInvalidField) firstInvalidField = "#BlockName";
            isValid = false;
        }

        if (themeName === "") {
            $("#ktheme").css("border-color", "red");
            $("#themeError").text("Kaizen Theme Name is required.");
            if (!firstInvalidField) firstInvalidField = "#ktheme";
            isValid = false;
        }
        if (plantName === "") {
            $("#teplplant").css("border-color", "red");
            $("#plantError").text("Line/Machine is required.");
            if (!firstInvalidField) firstInvalidField = "#teplplant";
            isValid = false;
        } 
        if (problemName === "") {
            $("#probstmt").css("border-color", "red");
            $("#probstmtError").text("Problem Statement  is required.");
            if (!firstInvalidField) firstInvalidField = "#probstmt";
            isValid = false;
        }
        if (counterMeasuremName === "") {
            $("#countmeasur").css("border-color", "red");
            $("#countmeasurError").text("Counter Measure  is required.");
            if (!firstInvalidField) firstInvalidField = "#countmeasur";
            isValid = false;
        }
        if (rootcauseproblem === "") {
            $("#rootcauseProblem").css("border-color", "red");
            $("#rootProblemError").text("Root Cause Problem is required.");
            if (!firstInvalidField) firstInvalidField = "#rootcauseProblem";
            isValid = false;
        }
        if (PresentConditions === "") { 
            $("#presentCondition").css("border-color", "red");
            $("#presentconditionsError").text("Present Conditions is required.");
            if (!firstInvalidField) firstInvalidField = "#presentCondition";
            isValid = false;
        }
        if (Improvements === "") {
            $("#improvementsCompleted").css("border-color", "red");
            $("#ImprovementsError").text("Improvements is required.");
            if (!firstInvalidField) firstInvalidField = "#improvementsCompleted";
            isValid = false;
        }      
        if (Benifits === "") {
            $("#benefit").css("border-color", "red");
            $("#BenefitsError").text("Benifits is required.");
            if (!firstInvalidField) firstInvalidField = "#benefit";
            isValid = false;
        }
        if (benifitarea.length === 0 && addedTeamMembers.length === 0) {
            swal({
                text: "Benefit Area is required & \n At least one team member must be added"
            });
            isValid = false;
        } else {
            if (benifitarea.length === 0) {
                swal("Benefit Area is required.");
                isValid = false;
            }
            if (addedTeamMembers.length === 0) {
                swal("At least one team member must be added.");
                isValid = false;
            }
        }
        if (document.getElementById('yesRadio').checked) {
            var inOthermc = $("#InOtherMC").val().trim();
            var withindept = $("#withinDept").val().trim();
            var Inotherdept = $("#InotherDept").val().trim();
            var otherpoints = $("#Otherpoints").val().trim();
            if (inOthermc === "") {
                $("#InOtherMC").css("border-color", "red");
                $("#otherError").text("In Other Machines is required.");
                if (!firstInvalidField) firstInvalidField = "#InOtherMC";
                isValid = false;
            }
            if (withindept === "") {
                $("#withinDept").css("border-color", "red");
                $("#withinError").text("Within the Department is required.");
                if (!firstInvalidField) firstInvalidField = "#withinDept";
                isValid = false;
            }
            if (Inotherdept === "") {
                $("#InotherDept").css("border-color", "red");
                $("#InotherError").text("In Other Dept/ Other Location is required.");
                if (!firstInvalidField) firstInvalidField = "#InotherDept";
                isValid = false;
            }
            if (otherpoints === "") {
                $("#Otherpoints").css("border-color", "red");
                $("#OtherpointsError").text("Other Relevant Points is required.");
                if (!firstInvalidField) firstInvalidField = "#Otherpoints";
                isValid = false;
            }
        }
        if (!isValid && firstInvalidField) {
            $(firstInvalidField).focus();
        }
        return isValid;
    }
    
    $(document).ready(function () {
        // Initialize all popovers
        $('[data-toggle="popover"]').popover();
        // $("#approvedbyIE").attr("disabled", "disabled");
        $("#approvedbyAccount").attr("disabled", "disabled");
        $("#btnSaveKaizen").click(function () {
            var checkboxData = {};
            var checkboxData1 = {};
            var Rootcausedata;
            var activityValue = [];
                    $('#checkboxform input[type=checkbox]:checked').each(function () {
                        activityValue.push($(this).val());
                    });
            var benifitarea = [];
                    $('#checkboxform1 input[type=checkbox]:checked').each(function () {
                        benifitarea.push($(this).val());
                    });
                // var selectData1 = { "selected": [] };
                // $('#multiple-select-field option:selected').each(function () {
                //     selectData1["selected"].push($(this).val());
                // Rootcausedata = selectData1["selected"].join(',');
                // });
            var addedTeamMembers = new Array();
            var addedDeployment = new Array();
            $('#tblteammemberResult tbody tr').each(function () {
                var row = $(this);
                var memberDetails = {};
                 if (row.find("TD").eq(2).val() != undefined) {
                memberDetails.EmpId = row.find("TD").eq(4).val();
                memberDetails.TeamMemberName = row.find("TD").eq(2).val();
                memberDetails.FunctionName = row.find("TD").eq(3).val();
                    // memberDetails.createdby = Accessor.HttpContext.Session.GetString("UserID");
                    // memberDetails.createdBy = row.find("TD").eq(4).val();
                    // memberDetails.createdBy = $("#loginIDuser").val();
                    // memberDetails.CreatedDate = $("#CDeta").val();
                   
                    // memberDetails.KaizenID = $("#kaizenid").val();
                    addedTeamMembers.push(memberDetails);
               }
            });

            $('#tblDeploymentrResult tbody tr').each(function () {
                var row = $(this);
                var deploymentDetails = {};
                if (row.find("TD").eq(1).val() != undefined) {
                    deploymentDetails.MC = row.find("TD").eq(1).val();
                    deploymentDetails.TargetDate = row.find("TD").eq(2).val();
                    deploymentDetails.Responsibility = row.find("TD").eq(3).val();
                    deploymentDetails.ScopeStatus = row.find("TD").eq(4).val();
                    // deploymentDetails.createdBy = $("#loginIDuser").val();
                    deploymentDetails.CreatedDate = $("#CDeta").val();
                    // deploymentDetails.KaizenID = $("#kaizenid").val();
                    addedDeployment.push(deploymentDetails);
                }
            });

            // var memberListJson = JSON.stringify(addedTeamMembers);
            // var deploymentListJson = JSON.stringify(addedDeployment);


            // Create FormData object
            var formData = new FormData();

           
            
            // Append text and file fields to formData

           
            formData.append('Block', $('#BlockName').val());
            formData.append('BlockDetails', $('#BlockName option:selected').text());
            formData.append('Activity', activityValue);
            formData.append('BenefitArea', benifitarea);
            formData.append('ActivityDesc', $('#activityDesc').val());
            formData.append('KaizenTheme', $('#ktheme').val());
            formData.append('plantName', $('#teplplant').val());
            formData.append('SuggestedKaizen', $('#suggestedKaizen').val());
            formData.append('ProblemStatement', $('#probstmt').val());
            formData.append('CounterMeasure', $('#countmeasur').val());
            formData.append('DocNo', $("#docNo").val());
            formData.append('VersionNoDate', $("#versionNo").val());
            formData.append('CostCentre', $("#codeCentre").val());
            formData.append('KaizenRefNo', $("#refNo").val());
            formData.append('Yield', $("#yield1").val());
            formData.append('CycleTime', $("#cycletime1").val());
            formData.append('Cost', $("#cost1").val());
            formData.append('ManPower', $("#Manpower").val());
            formData.append('Consumables', $("#Consumables").val());
            formData.append('Others', $("#Others").val());
            formData.append('TotalSavings', $("#TotalSavings").val());
            formData.append('ApprovedByIE', $("#approvedbyIe").val());
            formData.append('FinanceApprovedBy', $("#approvedbyAccount").val());
            formData.append('Rootcause', $("#rootcauseProblem").val());
            formData.append('MemberList', JSON.stringify(addedTeamMembers));
            formData.append('DeploymentList', JSON.stringify(addedDeployment));
            formData.append('RootCauseDetails', $("#rootcauseDetails").val());
            formData.append('PresentCondition', $("#presentCondition").val());
            formData.append('ImprovementsCompleted', $("#improvementsCompleted").val());
            if ($("#yesRadio").is(":checked")) { formData.append('HorozantalDeployment', true); }
            if ($("#noRadio").is(":checked")) { formData.append('HorozantalDeployment', false); }
            formData.append('InOtherMC', $('#InOtherMC').val());
            formData.append('WithIntheDept', $('#withinDept').val());
            formData.append('InotherDept', $('#InotherDept').val());
            formData.append('Otherpoints', $('#Otherpoints').val());
            formData.append('DRIApprovedBy', $('#driapprovedby').val());
            formData.append('DRIApprovedDate', $('#driapproveddate').val());
            formData.append('Benifits', $("#benefit").val());
            formData.append('OriginatedBy', $("#name").val());
            formData.append('Domain', $("#DomainId").val());
            formData.append('Department', $("#DeptId").val());
            formData.append('CreatedDate', $("#CDeta").val());
            formData.append('AttachmentBefore', $('#attach_file_before')[0].files[0]);
            formData.append('AttachmentAfter', $('#attach_file_after')[0].files[0]);
            formData.append('RootProblemAttachment', $('#attach_file2')[0].files[0]);

            //  additional attachments
            for (let i = 0; i < allFiles.length; i++) {
                formData.append('AdditionalAttachments', allFiles[i]);
            }

            if (!ValidateForm())
            {
                return;
            }
            //  AJAX 
            $.ajax({
                type: 'POST',
                url: '/CreateKaizen/NewKaizen',
                dataType: 'json',
                processData: false,
                contentType: false,
                data: formData,
                success: function (result) {
                    var redirectErrorUrl = "/Login/ErrorPage";
                    var redirectSucessUrl = "/SubmittedKaizen/ViewKaizen"; 
                    if (result.success) {
                        swal({
                            text: 'Kaizen Saved Successfully!!',
                            type: 'success'
                        }).then(function () {
                            // window.location.reload();
                            window.location.href = redirectSucessUrl;
                        });
                    } else {
                        swal('Unable to Save the Kaizen Details - Please Check the logs');
                        window.location.href = redirectErrorUrl;
                    }
                },
                error: function (error) {
                    swal('Unable to Save the Kaizen Details - Please Check the logs');
                    window.location.href = redirectErrorUrl;
                }
            });
            // updateGUID();
        });

        $("#btnSubmitKaizen").click(function () {
       var checkboxData = {};
       var checkboxData1 = {};
       // var Rootcausedata;
       var activityValue = [];
       $('#checkboxform input[type=checkbox]:checked').each(function () {
           activityValue.push($(this).val());
       });
       var benifitarea = [];
       $('#checkboxform1 input[type=checkbox]:checked').each(function () {
           benifitarea.push($(this).val());
       });
       // var selectData1 = { "selected": [] };
       // $('#multiple-select-field option:selected').each(function () {
       //     selectData1["selected"].push($(this).val());
       //     Rootcausedata = selectData1["selected"].join(',');
       // });
       var addedTeamMembers = new Array();
       var addedDeployment = new Array();
       $('#tblteammemberResult tbody tr').each(function () {
           var row = $(this);
           var memberDetails = {};
           if (row.find("TD").eq(2).val() != undefined) {
               memberDetails.EmpId = row.find("TD").eq(4).val();
               memberDetails.TeamMemberName = row.find("TD").eq(2).val();
               memberDetails.FunctionName = row.find("TD").eq(3).val();
               addedTeamMembers.push(memberDetails);
           }
       });
       $('#tblDeploymentrResult tbody tr').each(function () {
           var row = $(this);
           var deploymentDetails = {};
           if (row.find("TD").eq(1).val() != undefined) {
               deploymentDetails.MC = row.find("TD").eq(1).val();
               deploymentDetails.TargetDate = row.find("TD").eq(2).val();
               deploymentDetails.Responsibility = row.find("TD").eq(3).val();
               deploymentDetails.ScopeStatus = row.find("TD").eq(4).val();
               deploymentDetails.CreatedDate = $("#CDeta").val();
               addedDeployment.push(deploymentDetails);
           }
       });
       // Create FormData object
       var formData = new FormData();
       // Append text and file fields to formData
       formData.append('Block', $('#BlockName').val());
       formData.append('BlockDetails', $('#BlockName option:selected').text());
       formData.append('Activity', activityValue);
       formData.append('BenefitArea', benifitarea);
       formData.append('ActivityDesc', $('#activityDesc').val());
       formData.append('KaizenTheme', $('#ktheme').val());
       formData.append('plantName', $('#teplplant').val());
       formData.append('SuggestedKaizen', $('#suggestedKaizen').val());
       formData.append('ProblemStatement', $('#probstmt').val());
       formData.append('CounterMeasure', $('#countmeasur').val());
       formData.append('DocNo', $("#docNo").val());
       formData.append('VersionNoDate', $("#versionNo").val());
       formData.append('CostCentre', $("#codeCentre").val());
       formData.append('KaizenRefNo', $("#refNo").val());
       formData.append('Yield', $("#yield1").val());
       formData.append('CycleTime', $("#cycletime1").val());
       formData.append('Cost', $("#cost1").val());
       formData.append('ManPower', $("#Manpower").val());
       formData.append('Consumables', $("#Consumables").val());
       formData.append('Others', $("#Others").val());
       formData.append('TotalSavings', $("#TotalSavings").val());
       formData.append('ApprovedByIE', $("#approvedbyIe").val());
       formData.append('FinanceApprovedBy', $("#approvedbyAccount").val());
       formData.append('Rootcause', $("#rootcauseProblem").val());
       formData.append('MemberList', JSON.stringify(addedTeamMembers));
       formData.append('DeploymentList', JSON.stringify(addedDeployment));
       formData.append('RootCauseDetails', $("#rootcauseDetails").val());
       formData.append('PresentCondition', $("#presentCondition").val());
       formData.append('ImprovementsCompleted', $("#improvementsCompleted").val());
       if ($("#yesRadio").is(":checked")) { formData.append('HorozantalDeployment', true); }
       if ($("#noRadio").is(":checked")) { formData.append('HorozantalDeployment', false); }
       formData.append('InOtherMC', $('#InOtherMC').val());
       formData.append('WithIntheDept', $('#withinDept').val());
       formData.append('InotherDept', $('#InotherDept').val());
       formData.append('Otherpoints', $('#Otherpoints').val());
       formData.append('DRIApprovedBy', $('#driapprovedby').val());
       formData.append('DRIApprovedDate', $('#driapproveddate').val());
       formData.append('Benifits', $("#benefit").val());
       formData.append('OriginatedBy', $("#name").val());
       formData.append('Domain', $("#DomainId").val());
       formData.append('Department', $("#DeptId").val());
       formData.append('CreatedDate', $("#CDeta").val());
       formData.append('AttachmentBefore', $('#attach_file_before')[0].files[0]);
       formData.append('AttachmentAfter', $('#attach_file_after')[0].files[0]);
       formData.append('RootProblemAttachment', $('#attach_file2')[0].files[0]);
       //  additional attachments
            for (let i = 0; i < allFiles.length; i++) {
                formData.append('AdditionalAttachments', allFiles[i]);
            }
       if (!ValidateForm()) {
           return;
       }
       $.ajax({
           type: 'POST',
           url: '/CreateKaizen/SubmitKaizen',
           dataType: 'json',
           processData: false,
           contentType: false,
           data: formData,
           success: function (result) {
               if (result.success) {
                        var redirectErrorUrl = "/Login/ErrorPage";
                        var redirectSucessUrl = "/SubmittedKaizen/ViewKaizen";
                   swal({
                       text: 'Kaizen Submitted to DRI Successfully!!',
                       type: 'success'
                   }).then(function () {
                      // window.location.reload();
                            window.location.href = redirectSucessUrl;
                   });
               } else {
                   swal('Unable to Submit the Kaizen Details - Please Check the logs');
                        window.location.href = redirectErrorUrl;
               }
           },
           error: function (error) {
               swal('Unable to Submit the Kaizen Details - Please Check the logs');
                    window.location.href = redirectErrorUrl;
               console.error('Error:', error);
           }
       });
   });


        $("#btnUpdateKaizen").click(function () {
            debugger;
            var checkboxData = {};
            var checkboxData1 = {};
            var Rootcausedata;
            var activityValue = [];
                    $('#checkboxform input[type=checkbox]:checked').each(function () {
                        activityValue.push($(this).val());
                    });
            var benifitarea = [];
                    $('#checkboxform1 input[type=checkbox]:checked').each(function () {
                        benifitarea.push($(this).val());
                    });
            var addedTeamMembers = new Array();
            var addedDeployment = new Array();
            $('#tblteammemberResult tbody tr').each(function () {
                var row = $(this);
                var memberDetails = {};
                 if (row.find("TD").eq(2).val() != undefined) {
                memberDetails.EmpId = row.find("TD").eq(4).val();
                memberDetails.TeamMemberName = row.find("TD").eq(2).val();
                memberDetails.FunctionName = row.find("TD").eq(3).val();
                addedTeamMembers.push(memberDetails);
               }
            });

            $('#tblDeploymentrResult tbody tr').each(function () {
                var row = $(this);
                var deploymentDetails = {};
                if (row.find("TD").eq(1).val() != undefined) {
                    deploymentDetails.MC = row.find("TD").eq(1).val();
                    deploymentDetails.TargetDate = row.find("TD").eq(2).val();
                    deploymentDetails.Responsibility = row.find("TD").eq(3).val();
                    deploymentDetails.ScopeStatus = row.find("TD").eq(4).val();
                    // deploymentDetails.createdBy = $("#loginIDuser").val();
                    deploymentDetails.CreatedDate = $("#CDeta").val();
                    // deploymentDetails.KaizenID = $("#kaizenid").val();
                    addedDeployment.push(deploymentDetails);
                }
            });

            // var memberListJson = JSON.stringify(addedTeamMembers);
            // var deploymentListJson = JSON.stringify(addedDeployment);

            // Create FormData object
            var formData = new FormData();
            // Append text and file fields to formData
            formData.append('Id', $('#bindtxtID').text());
            formData.append('Block', $('#BlockName').val());
            formData.append('BlockDetails', $('#BlockName option:selected').text());
            formData.append('Activity', activityValue);
            formData.append('BenefitArea', benifitarea);
            formData.append('ActivityDesc', $('#activityDesc').val());
            formData.append('KaizenTheme', $('#ktheme').val());
            formData.append('plantName', $('#teplplant').val());
            formData.append('SuggestedKaizen', $('#suggestedKaizen').val());
            formData.append('ProblemStatement', $('#probstmt').val());
            formData.append('CounterMeasure', $('#countmeasur').val());
            formData.append('DocNo', $("#docNo").val());
            formData.append('VersionNoDate', $("#versionNo").val());
            formData.append('CostCentre', $("#codeCentre").val());
            formData.append('KaizenRefNo', $("#refNo").val());
            formData.append('Yield', $("#yield1").val());
            formData.append('CycleTime', $("#cycletime1").val());
            formData.append('Cost', $("#cost1").val());
            formData.append('ManPower', $("#Manpower").val());
            formData.append('Consumables', $("#Consumables").val());
            formData.append('Others', $("#Others").val());
            formData.append('TotalSavings', $("#TotalSavings").val());
            formData.append('ApprovedByIE', $("#approvedbyIe").val());
            formData.append('FinanceApprovedBy', $("#approvedbyAccount").val());
            formData.append('Rootcause', $("#rootcauseProblem").val());
            formData.append('MemberList', JSON.stringify(addedTeamMembers));
            formData.append('DeploymentList', JSON.stringify(addedDeployment));
            formData.append('RootCauseDetails', $("#rootcauseDetails").val());
            formData.append('PresentCondition', $("#presentCondition").val());
            formData.append('ImprovementsCompleted', $("#improvementsCompleted").val());
            if ($("#yesRadio").is(":checked")) { formData.append('HorozantalDeployment', true); }
            if ($("#noRadio").is(":checked")) { formData.append('HorozantalDeployment', false); }
            formData.append('InOtherMC', $('#InOtherMC').val());
            formData.append('WithIntheDept', $('#withinDept').val());
            formData.append('InotherDept', $('#InotherDept').val());
            formData.append('Otherpoints', $('#Otherpoints').val());
            formData.append('DRIApprovedBy', $('#driapprovedby').val());
            formData.append('DRIApprovedDate', $('#driapproveddate').val());
            formData.append('Benifits', $("#benefit").val());
            formData.append('OriginatedBy', $("#name").val());
            formData.append('Domain', $("#DomainId").val());
            formData.append('Department', $("#DeptId").val());
            formData.append('CreatedDate', $("#CDeta").val());
            formData.append('AttachmentBefore', $('#attach_file_before')[0].files[0]);
            formData.append('AttachmentAfter', $('#attach_file_after')[0].files[0]);
            formData.append('RootProblemAttachment', $('#attach_file2')[0].files[0]);

            //  additional attachments
            for (let i = 0; i < allFiles.length; i++) {
                formData.append('AdditionalAttachments', allFiles[i]);
            }

            if (!ValidateForm())
            {
                return;
            }
            //  AJAX 
            $.ajax({
                type: 'POST',
                url: '/CreateKaizen/UpdateKaizen',
                dataType: 'json',
                processData: false,
                contentType: false,
                data: formData,
                success: function (result) {
                    var redirectErrorUrl = "/Login/ErrorPage";
                    var redirectSucessUrl = "/SubmittedKaizen/ViewKaizen";
                    if (result.success) {
                        swal({
                            text: 'Kaizen Updated Successfully!!',
                            type: 'success'
                        }).then(function () {
                            window.location.href = redirectSucessUrl;
                        });
                    } else {
                        swal('Unable to Update the Kaizen Details - Please Check the logs');
                        window.location.href = redirectErrorUrl;
                    }
                },
                error: function (error) {
                    swal('Unable to Update the Kaizen Details - Please Check the logs');
                    window.location.href = redirectErrorUrl;
                }
            });
            // updateGUID();
        });


        $("#btnSubmittedStatus").click(function () {
            debugger;
            var checkboxData = {};
            var checkboxData1 = {};
            var Rootcausedata;
            var activityValue = [];
            $('#checkboxform input[type=checkbox]:checked').each(function () {
                activityValue.push($(this).val());
            });
            var benifitarea = [];
            $('#checkboxform1 input[type=checkbox]:checked').each(function () {
                benifitarea.push($(this).val());
            });
            var addedTeamMembers = new Array();
            var addedDeployment = new Array();
            $('#tblteammemberResult tbody tr').each(function () {
                var row = $(this);
                var memberDetails = {};
                if (row.find("TD").eq(2).val() != undefined) {
                    memberDetails.EmpId = row.find("TD").eq(4).val();
                    memberDetails.TeamMemberName = row.find("TD").eq(2).val();
                    memberDetails.FunctionName = row.find("TD").eq(3).val();
                    addedTeamMembers.push(memberDetails);
                }
            });

            $('#tblDeploymentrResult tbody tr').each(function () {
                var row = $(this);
                var deploymentDetails = {};
                if (row.find("TD").eq(1).val() != undefined) {
                    deploymentDetails.MC = row.find("TD").eq(1).val();
                    deploymentDetails.TargetDate = row.find("TD").eq(2).val();
                    deploymentDetails.Responsibility = row.find("TD").eq(3).val();
                    deploymentDetails.ScopeStatus = row.find("TD").eq(4).val();
                    deploymentDetails.CreatedDate = $("#CDeta").val();
                    addedDeployment.push(deploymentDetails);
                }
            });


            // Create FormData object
            var formData = new FormData();

            // Append text and file fields to formData
            formData.append('Id', $('#bindtxtID').text());
            formData.append('Block', $('#BlockName').val());
            formData.append('BlockDetails', $('#BlockName option:selected').text());
            formData.append('Activity', activityValue);
            formData.append('BenefitArea', benifitarea);
            formData.append('ActivityDesc', $('#activityDesc').val());
            formData.append('KaizenTheme', $('#ktheme').val());
            formData.append('plantName', $('#teplplant').val());
            formData.append('SuggestedKaizen', $('#suggestedKaizen').val());
            formData.append('ProblemStatement', $('#probstmt').val());
            formData.append('CounterMeasure', $('#countmeasur').val());
            formData.append('DocNo', $("#docNo").val());
            formData.append('VersionNoDate', $("#versionNo").val());
            formData.append('CostCentre', $("#codeCentre").val());
            formData.append('KaizenRefNo', $("#refNo").val());
            formData.append('Yield', $("#yield1").val());
            formData.append('CycleTime', $("#cycletime1").val());
            formData.append('Cost', $("#cost1").val());
            formData.append('ManPower', $("#Manpower").val());
            formData.append('Consumables', $("#Consumables").val());
            formData.append('Others', $("#Others").val());
            formData.append('TotalSavings', $("#TotalSavings").val());
            formData.append('ApprovedByIE', $("#approvedbyIe").val());
            formData.append('FinanceApprovedBy', $("#approvedbyAccount").val());
            formData.append('Rootcause', $("#rootcauseProblem").val());
            formData.append('MemberList', JSON.stringify(addedTeamMembers));
            formData.append('DeploymentList', JSON.stringify(addedDeployment));
            formData.append('RootCauseDetails', $("#rootcauseDetails").val());
            formData.append('PresentCondition', $("#presentCondition").val());
            formData.append('ImprovementsCompleted', $("#improvementsCompleted").val());
           // formData.append('HorozantalDeployment', $('input[name="horizontalDeployment"]:checked').val());
            if ($("#yesRadio").is(":checked")) { formData.append('HorozantalDeployment', true); }
            if ($("#noRadio").is(":checked")) { formData.append('HorozantalDeployment', false); }
            formData.append('InOtherMC', $('#InOtherMC').val());
            formData.append('WithIntheDept', $('#withinDept').val());
            formData.append('InotherDept', $('#InotherDept').val());
            formData.append('Otherpoints', $('#Otherpoints').val());
            formData.append('DRIApprovedBy', $('#driapprovedby').val());
            formData.append('DRIApprovedDate', $('#driapproveddate').val());
            formData.append('Benifits', $("#benefit").val());
            formData.append('OriginatedBy', $("#name").val());
            formData.append('Domain', $("#DomainId").val());
            formData.append('Department', $("#DeptId").val());
            formData.append('CreatedDate', $("#CDeta").val());
            formData.append('AttachmentBefore', $('#attach_file_before')[0].files[0]);
            formData.append('AttachmentAfter', $('#attach_file_after')[0].files[0]);
            formData.append('RootProblemAttachment', $('#attach_file2')[0].files[0]);

            //  additional attachments
            for (let i = 0; i < allFiles.length; i++) {
                formData.append('AdditionalAttachments', allFiles[i]);
            }

            if (!ValidateForm()) {
                return;
            }
            //  AJAX
            $.ajax({
                type: 'POST',
                url: '/CreateKaizen/UpdateSubmittedKaizen',
                dataType: 'json',
                processData: false,
                contentType: false,
                data: formData,
                success: function (result) {
                    var redirectErrorUrl = "/Login/ErrorPage";
                    var redirectSucessUrl = "/SubmittedKaizen/ViewKaizen";
                    if (result.success) {
                        swal({
                            text: 'Kaizen Submitted Successfully!!',
                            type: 'success'
                        }).then(function () {
                            window.location.href = redirectSucessUrl;
                        });
                    } else {
                        swal('Unable to Submit the Kaizen Details - Please Check the logs');
                        window.location.href = redirectErrorUrl;
                    }
                },
                error: function (error) {
                    swal('Unable to Submit the Kaizen Details - Please Check the logs');
                    window.location.href = redirectErrorUrl;
                }
            });
            // updateGUID();
        });

    });

</script>

 <script>
    function previewImage(event, targetId) {
        var uploadedImageContainer = $('#' + targetId);
        uploadedImageContainer.empty();

        var file = event.target.files[0];
        var fileName = file.name;
        var isValid = validate_fileupload(fileName);
        if (!isValid) {
            console.log('Invalid file type');
            return;
        }

        var imgElement = $('<img>', {
            src: URL.createObjectURL(event.target.files[0]),
            alt: 'Uploaded Image'
        });

        var deleteButton = $('<div>', {
            class: 'delete-btn',
            text: 'Delete',
            click: function () {
                swal({
                    text: "Are you sure you want to Delete?",
                    buttons: {
                        confirm: "Yes",
                        cancel: "No"
                    }
                }).then((userConfirmation) => {
                    if (userConfirmation) {
                        uploadedImageContainer.empty();
                        $('#' + event.target.id).val(''); 
                        $('#' + targetId).closest('.inpfilelabel').find('.upload-interface').show();
                        $('#' + targetId).closest('.inpfilelabel').css('padding', '30px');
                        $('#' + targetId).closest('.inpfilelabel').css('border', '1px dashed #797A89');
                        $('#upload_area').addClass('grayed-out');
                        img.parentElement.remove();

                    }
                });
            }
        });
        deleteButton.css({
            'margin-left': '10px',
            'margin-top': '5px' 
        });
        uploadedImageContainer.append(imgElement, deleteButton);
        if ($('#attach_file_before').get(0).files.length > 0 && $('#attach_file_after').get(0).files.length > 0) {
            $('#upload_area').removeClass('grayed-out');
        }
        else {
            $('#upload_area').addClass('grayed-out');
        }
        if (event.target.files.length > 0) {
            $('#' + targetId).closest('.inpfilelabel').find('.upload-interface').hide();
            $('#' + targetId).closest('.inpfilelabel').css('padding', '4px');
            $('#' + targetId).closest('.delete-btn').css('padding', '2px 5px');
            $('#' + targetId).closest('.inpfilelabel').css('border', 'none');
        }
    }
    function validate_fileupload(fileName) {
        var allowed_extensions = new Array("jpg", "png", "gif");
        var file_extension = fileName.split('.').pop().toLowerCase();

        for (var i = 0; i < allowed_extensions.length; i++) {
            if (allowed_extensions[i] == file_extension) {
                return true; 
            }
        }
        swal("Invalid file type" + fileName);
        return false;
    }
//mutli files    
    var imgNo = 0;
    let allFiles = [];

    function previewAdditionalImages(event) {
        let newFiles = event.target.files;
        for (let i = 0; i < newFiles.length; i++) {
            allFiles.push(newFiles[i]);
            previewFile(newFiles[i]);
        }
    }

    function previewFile(file) {
        var allowed_extensions = new Set(["jpg", "jpeg", "png", "gif"]);
        var fileName = file.name;
        var file_extension = fileName.split('.').pop().toLowerCase();

        if (!allowed_extensions.has(file_extension)) {
            swal("Invalid file type: " + fileName);
            return;
        }

        var reader = new FileReader();
        reader.onload = function (event) {
            var img = document.createElement("img");
            img.src = event.target.result;
            img.className = "uploadImageSmall";
            img.id = "imageID" + imgNo;
            imgNo = imgNo + 1;

            var deleteBtn = document.createElement("span");
            deleteBtn.className = "delete-btn delbutt";
            deleteBtn.textContent = "Delete";
            deleteBtn.onclick = function () {
                swal({
                    text: "Are you sure you want to delete?",
                    buttons: {
                        confirm: "Yes",
                        cancel: "No"
                    }
                }).then((userConfirmation) => {
                    if (userConfirmation) {
                        deleteBtn.parentElement.parentElement.remove();
                    }
                });
            };
            var div = document.createElement("div");
            div.className = "col-md-3 col-sm-4";
            div.innerHTML = `<div class="inpfilelabel-attm mt-2 mb-2 p-2">${img.outerHTML}</div>`;
            div.querySelector('.inpfilelabel-attm').appendChild(deleteBtn);

            var output = document.getElementById('preview_area');
            var uploadArea = document.getElementById('upload_area');
            output.insertBefore(div, uploadArea.parentElement);
        };
        reader.readAsDataURL(file);
    }
</script>
<script>
    $(function getSession() {
        if (sessionStorage.getItem("editKaizen")) {
            
           
                
            
            function makeDivReadOnly() {
                var div = document.getElementById('ReadOnly');
                var elements = div.querySelectorAll('input, button, textarea, select');

                elements.forEach(element => {
                    if (element.tagName === 'INPUT') {
                        if (element.type === 'radio' || element.type === 'checkbox') {
                            element.disabled = true;
                        } else {
                            element.readOnly = true;
                        }
                    } else if (element.tagName === 'TEXTAREA') {
                        element.readOnly = true;
                    } else if (element.tagName === 'SELECT') {
                        element.disabled = true;
                    }
                });

                var specificIds = ['BenefitArea', 'ActivityDesc', 'presentCondition', 'rootcauseDetails', 'improvementsCompleted', 'deleteimgid', , 'deleteimgid', 'btnAddDeployment', 'btnDeleteDeployment', 'teamAddBtn', 'teamDelBtn'];

                specificIds.forEach(id => {
                    var specificElement = document.getElementById(id);
                    if (specificElement) {
                        if (specificElement.tagName === 'INPUT') {
                            if (specificElement.type === 'radio' || specificElement.type === 'checkbox') {
                                specificElement.disabled = true;
                            } else {
                                specificElement.readOnly = true;
                            }
                        } else if (specificElement.tagName === 'TEXTAREA') {
                            specificElement.readOnly = true;
                        } else if (specificElement.tagName === 'SELECT') {
                            specificElement.disabled = true;
                        } else if (specificElement.tagName === 'BUTTON') {
                            specificElement.disabled = true;
                        }
                    }
                });
            }
            var editKaizen = JSON.parse(sessionStorage.getItem("editKaizen"));
            var KaizenId = editKaizen['kaizenid'];
            var Usertype = editKaizen['edituser'];
            if (Usertype == 'view')
            {
                makeDivReadOnly();
               

            }
            var userRole = $('#Userrole').data('role');
            $('#saveItButton').show();
            switch (userRole) {
                case 'IE DEPT':
                     $('#saveItButton').hide();
                    break;
                case 'FINNACE':                
                    $('#saveItButton').hide();
                    break;
                case 'ADMIN':                    
                    $('#saveItButton').hide();                   
                    break;
            }
            $.ajax({
                type: 'GET',
                url: '/CreateKaizen/GetKaizendetailsById',
                dataType: "json",
                data:
                {
                    KaizenId: KaizenId
                },
                success: function (result) {
                    if (result) {
                        debugger;
                        const statusdetails = {
                            
                            submitted:1,
                            ImageApproved: 2,
                            ImageRejected: 3,
                            DRIApproved: 4,
                            DRIRejected: 5,
                            IEApproved: 6,
                            IERejected: 7,
                            FinanceApproved: 8,
                            FinanceRejected: 9,
                            Pending: 10,
                            DRIPending: 11,
                            IEPending: 12,
                            FinancePending: 13
                        };

                        // Reverse lookup to get the status name by its number
                        const reverseStatusDetails = {};
                        for (const [key, value] of Object.entries(statusdetails)) {
                            reverseStatusDetails[value] = key;
                        }

                        var statusDesc = result.kaizenList[0].approvalStatus;
                       


                        if (statusDesc === statusdetails.FinanceApproved || statusDesc === statusdetails.FinanceRejected || statusDesc === statusdetails.FinancePending) {
                            $('#financestatusid').text(reverseStatusDetails[statusDesc]).addClass(statusDesc === statusdetails.FinanceRejected ? 'rejected' : (statusDesc === statusdetails.FinancePending ? 'pending' : 'approved'));
                            $('#IEDept').show();
                            $('#FinanceDept').show();
                            $('#DRIDept').show();
                            $('#ImageApprover').show();
                            $('#saveItButton').hide();
                            if (statusDesc === statusdetails.FinanceRejected) {
                                $("#finRejectedReason").text(result.kaizenList[0].rejectionreason);
                            }
                            $('#iestatusid').text(reverseStatusDetails[statusdetails.IEApproved]).addClass('approved');
                            $('#imagestatusid').text(reverseStatusDetails[statusdetails.ImageApproved]).addClass('approved');
                            $('#dristatusid').text(reverseStatusDetails[statusdetails.DRIApproved]).addClass('approved');
                        } else if (statusDesc === statusdetails.IEApproved || statusDesc === statusdetails.IERejected || statusDesc === statusdetails.IEPending) {
                            $('#saveItButton').hide();
                            $('#iestatusid').text(reverseStatusDetails[statusDesc]).addClass(statusDesc === statusdetails.IERejected ? 'rejected' : (statusDesc === statusdetails.IEPending ? 'pending' : 'approved'));
                            $('#IEDept').show();
                            $('#DRIDept').show();
                            $('#ImageApprover').show();
                            if (statusDesc === statusdetails.IERejected) {
                                $("#ieRejectedReason").text(result.kaizenList[0].rejectionreason);
                                $('#FinanceDept').hide();
                            }
                            $('#imagestatusid').text(reverseStatusDetails[statusdetails.ImageApproved]).addClass('approved');
                            $('#dristatusid').text(reverseStatusDetails[statusdetails.DRIApproved]).addClass('approved');
                        } else if (statusDesc === statusdetails.DRIApproved || statusDesc === statusdetails.DRIRejected || statusDesc === statusdetails.DRIPending) {

                            $('#DRIDept').show();
                            $('#ImageApprover').show();
                            $('#dristatusid').text(reverseStatusDetails[statusDesc]).addClass(statusDesc === statusdetails.DRIRejected ? 'rejected' : (statusDesc === statusdetails.DRIPending ? 'pending' : 'approved'));
                            if (statusDesc === statusdetails.DRIRejected) {
                                $("#driRejectedReason").text(result.kaizenList[0].rejectionreason);
                                 $('#IEDept').hide();
                                 $('#FinanceDept').hide();

                            }
                            $('#imagestatusid').text(reverseStatusDetails[statusdetails.ImageApproved]).addClass('approved');
                        } else if (statusDesc === statusdetails.ImageApproved || statusDesc === statusdetails.ImageRejected) {
                            $('#imagestatusid').text(reverseStatusDetails[statusDesc]).addClass(statusDesc === statusdetails.ImageRejected ? 'rejected' : 'approved');
                            $('#ImageApprover').show();
                            if (statusDesc === statusdetails.ImageRejected) {
                                $('#IEDept').hide();
                                $('#FinanceDept').hide();
                                $('#DRIDept').hide();


                            }
                        } else if (statusDesc === statusdetails.Pending || statusDesc === statusdetails.DRIPending || statusDesc === statusdetails.IEPending || statusDesc === statusdetails.FinancePending) {
                            $('#pendingstatusid').text(reverseStatusDetails[statusDesc]).addClass('pending');
                        }
                        else if (statusDesc === statusdetails.submitted && userRole === 'ADMIN') {
                            $('#approvers').hide();
                        }
                        else if(statusDesc === statusdetails.submitted && userRole != 'EMPLOYEE')
                        {
                            $('#approvers').show();
                        }
                        else{
                            $('#approvers').hide();
                          
                        }
                        $('#bindtxtID').text(result.kaizenList[0].id);
                        $('#ieDateTime').text(result.kaizenList[0].ieApprovedDate);
                        $('#driDateTime').text(result.kaizenList[0].driApprovedDate);
                        $('#finDateTime').text(result.kaizenList[0].financeApprovedDate);
                        $('#statusid').text(result.kaizenList[0].approvalstatusdesc);
                        $('#dDept').text(result.approverslist[0].driDept);
                        $('#driName').text(result.approverslist[0].driName);
                        $('#driEmail').text(result.approverslist[0].driEmail);
                        $('#dDom').text(result.approverslist[0].driDomain);

                        $('#ieeDept').text(result.approverslist[0].ieDept);
                        $('#ieName').text(result.approverslist[0].iEname);
                        $('#ieEmail').text(result.approverslist[0].ieEmail);
                        $('#ieeDom').text(result.approverslist[0].ieDomain);

                        $('#finDept').text(result.approverslist[0].finDept);
                        $('#finName').text(result.approverslist[0].finnaceName );
                        $('#finEmail').text(result.approverslist[0].financeEmail);
                        $('#finDom').text(result.approverslist[0].finDomain);
                      
                        $('#imageaprName').text(result.approverslist[0].imageAproveName);
                        
                        $("#docNo").val(result.kaizenList[0].docNo);
                        $('#printPDF').show();
                        $('#btnUpdateKaizen').show();
                        $('#btnSubmittedStatus').show(); 
                        $('#btnSaveKaizen').hide();
                        $('#btnSubmitKaizen').hide();

                        $('#Srno').show();
                        $('#kaizenrefNo').show();
                        $('#backbtn').show();

                        $("#versionNo").val(result.kaizenList[0].versionNoDate);
                        $("#refNo").val(result.kaizenList[0].kaizenRefNo);
                        $("#codeCentre").val(result.kaizenList[0].costCentre);
                        var ActivityValue = result.kaizenList[0].activity;
                        var activityname = ActivityValue.split(',');
                        activityname.forEach(function (activityname) {
                            $("#id" + activityname.trim()).prop("checked", true);
                        });
                        $("#activityDesc").val(result.kaizenList[0].activityDesc);
                        var benifitvalue = result.kaizenList[0].benefitArea;
                        var checkboxname = benifitvalue.split(',');
                        checkboxname.forEach(function (checkboxname) {
                            $("#i" + checkboxname.trim()).prop("checked", true);
                        });
                        $('#BlockName option').map(function () {
                            if ($(this).text() == result.kaizenList[0].block) return this;
                        }).attr('selected', 'selected').change();
                        $("#teplplant").val(result.kaizenList[0].blockDetails);
                        $("#ktheme").val(result.kaizenList[0].kaizenTheme);
                        $("#suggestedKaizen").val(result.kaizenList[0].suggestedKaizen);
                        $("#probstmt").val(result.kaizenList[0].problemStatement);
                        $("#countmeasur").val(result.kaizenList[0].counterMeasure);
                        $("#yield1").val(result.kaizenList[0].yield);
                        $("#cycletime1").val(result.kaizenList[0].cycleTime);
                        $("#cost1").val(result.kaizenList[0].cost);
                        $("#Manpower").val(result.kaizenList[0].manPower);
                        $("#Consumables").val(result.kaizenList[0].consumables);
                        $("#Others").val(result.kaizenList[0].others);
                        $("#TotalSavings").val(result.kaizenList[0].totalSavings);
                        // var rootCauses = result.kaizenList[0].rootCause.split(',').map(item => item.trim());
                        // $('#multiple-select-field option').each(function () {
                        //     if (rootCauses.includes($(this).text())) {
                        //         $(this).prop('selected', true);
                        //     }
                        // }).change();
                        $('#approvedbyIe option').map(function () {
                            if ($(this).text() == result.kaizenList[0].approvedByIE) return this;
                        }).attr('selected', 'selected').change();
                        $("#rootcauseProblem").val(result.kaizenList[0].rootCause);
                        $("#presentCondition").val(result.kaizenList[0].presentCondition);
                        $("#improvementsCompleted").val(result.kaizenList[0].improvementsCompleted);
                        $("#rootcauseDetails").val(result.kaizenList[0].rootCauseDetails);
                        $("#benefit").val(result.kaizenList[0].benifits);
                        $("#InOtherMC").val(result.kaizenList[0].inOtherMc);
                        $("#withinDept").val(result.kaizenList[0].withIntheDept);
                        $("#InotherDept").val(result.kaizenList[0].inOtherDept);
                        $("#Otherpoints").val(result.kaizenList[0].otherPoints);
                      //Edit Iedepart 
                        var costValue = $("#cost1").val();
                        var approvedBySection = $('#approvedBySection');
                        if (costValue.length >= 6) {
                            approvedBySection.addClass('show');
                        } else {
                            approvedBySection.removeClass('show');
                        }
                        //Edit finance
                        var cycletime = $("#cycletime1").val();
                        var manPower = $("#Manpower").val();
                        var ApprovedByieContainer = $('#approvedByIeContainer');
                        if (cycletime !== ''|| manPower !== '') {
                            ApprovedByieContainer.addClass('show');
                        } else {
                            ApprovedByieContainer.removeClass('show');
                        }

                        var dateStr = result.kaizenList[0].driApprovedDate;
                        var parts = dateStr.split('-');
                        var day = parts[0];
                        var month = parts[1];
                        var year = parts[2];
                        var formattedDate = `${year}-${month}-${day}`;
                        $("#driapproveddate").val(formattedDate);

                        if (result.kaizenList[0].horozantalDeployment === true) {
                            $("#yesRadio").prop("checked", true);
                            document.getElementById('toggleContent').style.display = 'block';
                        } 
                        else if (result.kaizenList[0].horozantalDeployment === false) {
                            $("#noRadio").prop("checked", true);
                            document.getElementById('toggleContent').style.display = 'none';
                        } 
                        $("#CDeta").val(result.kaizenList[0].originatedDate);
                        $("#DomainId").val(result.kaizenList[0].dept);
                        $("#name").val(result.kaizenList[0].originatedBy); 
                        $("#DeptId").val(result.kaizenList[0].dept);
                        var mytable = document.getElementById("tblteammemberResult");
                        result.teamList.forEach(item => {
                            var rows = mytable.rows.length;
                            var r = mytable.insertRow(rows);

                            var c1 = r.insertCell(0);
                            var c2 = r.insertCell(1);
                            var c3 = r.insertCell(2);
                            var c4 = r.insertCell(3);

                            var checkbox = document.createElement("input");
                            var empId = document.createElement("input");
                            var teamMemberName = document.createElement("input");
                            var functionName = document.createElement("input");

                            checkbox.type = "checkbox";
                            empId.type = "text";
                            empId.value = item.empId;
                            empId.readOnly = true;
                            empId.className = "input-width";
                            teamMemberName.type = "text";
                            teamMemberName.readOnly = true;
                            teamMemberName.value = item.teamMemberName; 
                            teamMemberName.className = "input-width";
                            functionName.type = "text";
                            functionName.value = item.functionName;
                            functionName.className = "input-width";
                            functionName.readOnly = true;

                            c1.appendChild(checkbox);
                            c2.appendChild(empId);
                            c3.appendChild(teamMemberName);
                            c4.appendChild(functionName);

                            c1.style.width = '5%';
                            c2.style.width = '31%';
                            c3.style.width = '32%';
                            c4.style.width = '32%';
                        });
                        var mytable = document.getElementById("tblDeploymentrResult");
                        result.scopeList.forEach(item => {
                            var rows = mytable.rows.length;
                            var r = mytable.insertRow(rows);
                            var Ad1 = r.insertCell(0);
                            var Ad2 = r.insertCell(1);
                            var Ad3 = r.insertCell(2);
                            var Ad4 = r.insertCell(3);
                            var Ad5 = r.insertCell(4);

                            var checkbox = document.createElement("input");
                            var Sno = document.createElement("input");
                            var mc = document.createElement("input");
                            var targetDate = document.createElement("input");
                            var responsibility = document.createElement("input");
                            var status = document.createElement("input");

                            checkbox.type = "checkbox";
                            Sno.type = "text";
                            Sno.value = $("#txtNo").val();
                            Sno.readOnly = true;
                            Sno.className = "input-width";
                            mc.type = "text";
                            mc.value = item.mc; 
                            mc.className = "input-width";
                            mc.readOnly = true;
                            targetDate.type = "text";
                            targetDate.value = item.targetFormatDate;
                            targetDate.readOnly = true;
                            targetDate.className = "input-width";
                            responsibility.type = "text";
                            responsibility.value = item.responsibility;
                            responsibility.className = "input-width";
                            responsibility.readOnly = true;
                            status.type = "text";
                            status.value = item.scopeStatus; 
                            status.className = "input-width";
                            status.readOnly = true;

                            Ad1.appendChild(checkbox);
                            Ad2.appendChild(mc);
                            Ad3.appendChild(targetDate);
                            Ad4.appendChild(responsibility);
                            Ad5.appendChild(status);

                            Ad2.className = 'col-cd-2';
                            Ad3.className = 'col-cd-4';
                            Ad4.className = 'col-cd-3';
                            Ad5.className = 'col-cd-3';
                        });

                        result.attachmentsList.forEach(item => {
                            var popupShown = false;
                            var base64String = item.fileName;
                            var attachmentType = item.attachmentType;
                            var FilePath = item.filePath;
                            var fileExtension = FilePath.split('.').pop().toLowerCase();

                            var ImageType = "";
                            if (fileExtension === "jpg" || fileExtension === "jpeg") 
                            {
                                ImageType = "image/jpeg";
                            }
                            else if (fileExtension === "png") 
                            {
                                ImageType = "image/png";
                            }
                            else 
                            {
                                ImageType = "image/jpeg";
                            }

                            var imgContainer = $('<div>', { class: 'img-container' });

                            var imgElement = $('<img>', {
                                src: `data:${ImageType};base64,${base64String}`,
                                alt: 'Image'
                            });

                            var deleteButton = $('<button>', {
                                text: 'Delete',
                                class: 'delete-btn',
                               id:'deleteimgid',
                            });

                            imgContainer.append(imgElement, deleteButton);
                            imgElement.on('error', function () {
                                imgContainer.remove();
                                $('#file-image-before-text').show();
                                $('#file-image-before').show();
                                $('#file-image-after-text').show();
                                $('#file-image-after').show();
                                $('#file-image-text').show();
                                $('#file-image').show();
                                if (!popupShown) 
                                {
                                    swal('Failed to load attachment(s).');
                                    popupShown = true;
                                }
                            });

                            if (attachmentType === "AttachmentBefore") {
                                $('#file-image-before-text').hide();
                                $('#file-image-before').hide();
                                $('#uploaded_before_image').append(imgContainer);
                            }
                            if (attachmentType === "AttachmentAfter") {
                                $('#file-image-after-text').hide();
                                $('#file-image-after').hide();
                                $('#uploaded_after_image').append(imgContainer);
                            }
                            if (attachmentType === "RootProblemAttachment") {
                                $('#file-image-text').hide();
                                $('#file-image').hide();
                                $('#uploaded_attach2_image').append(imgContainer);
                            }
                            if (attachmentType === "AdditionalAttachment") {
                                $('#upload_area').removeClass('grayed-out');
                                $('#uploaded_additional_image').append(imgContainer);
                                $('#file-image-additional').show();
                                $('#file-image-additional-text').show();
                                $('#upload_area').show();
                            }
                            deleteButton.on('click', function () {
                                swal({
                                    text: "Are you sure you want to Delete?",
                                    buttons: {
                                        confirm: "Yes",
                                        cancel: "No"
                                    }
                                }).then((userConfirmation) => {
                                    if (userConfirmation) {
                                        if (attachmentType === "AttachmentBefore") {

                                            $('#file-image-before-text').show();
                                            $('#file-image-before').show();
                                        }
                                        if (attachmentType === "AttachmentAfter") {
                                            $('#file-image-after-text').show();
                                            $('#file-image-after').show();
                                        }
                                        if (attachmentType === "RootProblemAttachment") {
                                            $('#file-image-text').show();
                                            $('#file-image').show();
                                        }
                                        imgContainer.remove();
                                    }
                                });

                            });
                        });
                    }
                    else 
                    {
                        
                    }
                },
                error: function (error) {
                }
            });       
            sessionStorage.removeItem("editKaizen");
        } 
        else 
        {
            sessionStorage.removeItem("editKaizen");
            
        }
    });
</script>
 